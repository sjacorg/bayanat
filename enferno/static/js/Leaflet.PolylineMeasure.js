/**
 * Minified by jsDelivr using Terser v5.37.0.
 * Original file: /npm/leaflet.polylinemeasure@3.0.0/Leaflet.PolylineMeasure.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(i){if("function"==typeof define&&define.amd)define(["leaflet"],i);else if("undefined"!=typeof module)module.exports=i(require("leaflet"));else{if(void 0===window.L)throw new Error("Leaflet must be loaded first");i(window.L)}}((function(i){var t="polyline-measure-unicode-icon";return i.Control.PolylineMeasure=i.Control.extend({options:{position:"topleft",unit:"metres",clearMeasurementsOnStop:!0,showBearings:!1,bearingTextIn:"In",bearingTextOut:"Out",tooltipTextFinish:"Click to <b>finish line</b><br>",tooltipTextDelete:"Press SHIFT-key and click to <b>delete point</b>",tooltipTextMove:"Click and drag to <b>move point</b><br>",tooltipTextResume:"<br>Press CTRL-key and click to <b>resume line</b>",tooltipTextAdd:"Press CTRL-key and click to <b>add point</b>",measureControlTitleOn:"Turn on PolylineMeasure",measureControlTitleOff:"Turn off PolylineMeasure",measureControlLabel:"&#8614;",measureControlClasses:[],showClearControl:!1,clearControlTitle:"Clear Measurements",clearControlLabel:"&times;",clearControlClasses:[],showUnitControl:!1,distanceShowSameUnit:!1,unitControlTitle:{text:"Change Units",metres:"metres",landmiles:"land miles",nauticalmiles:"nautical miles"},unitControlLabel:{metres:"m",kilometres:"km",feet:"ft",landmiles:"mi",nauticalmiles:"nm"},tempLine:{color:"#00f",weight:2},fixedLine:{color:"#006",weight:2},startCircle:{color:"#000",weight:1,fillColor:"#0f0",fillOpacity:1,radius:3},intermedCircle:{color:"#000",weight:1,fillColor:"#ff0",fillOpacity:1,radius:3},currentCircle:{color:"#000",weight:1,fillColor:"#f0f",fillOpacity:1,radius:6},endCircle:{color:"#000",weight:1,fillColor:"#f00",fillOpacity:1,radius:3}},_arcpoints:100,_circleNr:-1,_lineNr:-1,_createControl:function(t,e,o,r,s,n){var l=document.createElement("a");return l.innerHTML=t,l.setAttribute("title",e),o.forEach((function(i){l.classList.add(i)})),i.DomEvent.on(l,"click",s,n),r.appendChild(l),l},onAdd:function(e){var o=this;e.on("movestart ",(function(){o._mapdragging=!0})),this._container=document.createElement("div"),this._container.classList.add("leaflet-bar"),i.DomEvent.disableClickPropagation(this._container);var r=this.options.measureControlTitleOn,s=this.options.measureControlLabel,n=this.options.measureControlClasses;if(-1!=s.indexOf("&")&&n.push(t),this._arrPolylines=[],this._measureControl=this._createControl(s,r,n,this._container,this._toggleMeasure,this),this._defaultControlBgColor=this._measureControl.style.backgroundColor,this._measureControl.setAttribute("id","polyline-measure-control"),this.options.showClearControl){r=this.options.clearControlTitle,s=this.options.clearControlLabel,n=this.options.clearControlClasses;-1!=s.indexOf("&")&&n.push(t),this._clearMeasureControl=this._createControl(s,r,n,this._container,this._clearAllMeasurements,this),this._clearMeasureControl.classList.add("polyline-measure-clearControl")}if(this.options.showUnitControl){if("metres"==this.options.unit)s=this.options.unitControlLabel.metres,r=this.options.unitControlTitle.text+" ["+this.options.unitControlTitle.metres+"]";else if("landmiles"==this.options.unit)s=this.options.unitControlLabel.landmiles,r=this.options.unitControlTitle.text+" ["+this.options.unitControlTitle.landmiles+"]";else s=this.options.unitControlLabel.nauticalmiles,r=this.options.unitControlTitle.text+" ["+this.options.unitControlTitle.nauticalmiles+"]";n=[];this._unitControl=this._createControl(s,r,n,this._container,this._changeUnit,this),this._unitControl.setAttribute("id","unitControlId")}return this._container},onRemove:function(){this._measuring&&this._toggleMeasure()},_saveNonpolylineEvents:function(){this._nonpolylineTargets=this._map._targets,void 0!==this._polylineTargets?this._map._targets=this._polylineTargets:this._map._targets={}},_savePolylineEvents:function(){this._polylineTargets=this._map._targets,this._map._targets=this._nonpolylineTargets},_toggleMeasure:function(){this._measuring=!this._measuring,this._measuring?(this._mapdragging=!1,this._saveNonpolylineEvents(),this._measureControl.classList.add("polyline-measure-controlOnBgColor"),this._measureControl.style.backgroundColor=this.options.backgroundColor,this._measureControl.title=this.options.measureControlTitleOff,this._oldCursor=this._map._container.style.cursor,this._map._container.style.cursor="crosshair",this._doubleClickZoom=this._map.doubleClickZoom.enabled(),this._map.doubleClickZoom.disable(),this._layerPaint||(this._layerPaint=i.layerGroup().addTo(this._map)),this._map.on("mousemove",this._mouseMove,this),this._map.on("click",this._mouseClick,this),i.DomEvent.on(document,"keydown",this._onKeyDown,this),this._resetPathVariables()):(this._savePolylineEvents(),this._measureControl.classList.remove("polyline-measure-controlOnBgColor"),this._measureControl.style.backgroundColor=this._defaultControlBgColor,this._measureControl.title=this.options.measureControlTitleOn,this._map._container.style.cursor=this._oldCursor,this._map.off("mousemove",this._mouseMove,this),this._map.off("click",this._mouseClick,this),this._map.off("mousemove",this._resumeFirstpointMousemove,this),this._map.off("click",this._resumeFirstpointClick,this),this._map.off("mousemove",this._dragCircleMousemove,this),this._map.off("mouseup",this._dragCircleMouseup,this),i.DomEvent.off(document,"keydown",this._onKeyDown,this),this._doubleClickZoom&&this._map.doubleClickZoom.enable(),this.options.clearMeasurementsOnStop&&this._layerPaint&&this._clearAllMeasurements(),0!==this._cntCircle&&this._finishPolylinePath()),this._map.fire("polylinemeasure:toggle",{sttus:this._measuring})},_clearAllMeasurements:function(){void 0!==this._cntCircle&&0!==this._cntCircle&&this._finishPolylinePath(),this._layerPaint&&this._layerPaint.clearLayers(),this._arrPolylines=[],this._map.fire("polylinemeasure:clear")},_changeUnit:function(){"metres"==this.options.unit?(this.options.unit="landmiles",document.getElementById("unitControlId").innerHTML=this.options.unitControlLabel.landmiles,this._unitControl.title=this.options.unitControlTitle.text+" ["+this.options.unitControlTitle.landmiles+"]"):"landmiles"==this.options.unit?(this.options.unit="nauticalmiles",document.getElementById("unitControlId").innerHTML=this.options.unitControlLabel.nauticalmiles,this._unitControl.title=this.options.unitControlTitle.text+" ["+this.options.unitControlTitle.nauticalmiles+"]"):(this.options.unit="metres",document.getElementById("unitControlId").innerHTML=this.options.unitControlLabel.metres,this._unitControl.title=this.options.unitControlTitle.text+" ["+this.options.unitControlTitle.metres+"]"),this._currentLine&&this._computeDistance(this._currentLine),this._arrPolylines.map(this._computeDistance.bind(this))},_computeDistance:function(i){var t=0;i.circleCoords.map(function(e,o){if(o>=1){var r=i.circleCoords[o-1].distanceTo(i.circleCoords[o]);t+=r,this._updateTooltip(i.tooltips[o],i.tooltips[o-1],t,r,i.circleCoords[o-1],i.circleCoords[o])}}.bind(this))},_onKeyDown:function(i){if(27===i.keyCode){if(!0===this._resumeFirstpointFlag){this._resumeFirstpointFlag=!1;var t=this._lineNr;this._map.off("mousemove",this._resumeFirstpointMousemove,this),this._map.off("click",this._resumeFirstpointClick,this),this._layerPaint.removeLayer(this._rubberlinePath2),this._layerPaint.removeLayer(this._tooltipNew),this._arrPolylines[t].circleMarkers[0].setStyle(this.options.startCircle);var e="",o=0;return!0===this.options.showBearings&&(e=this.options.bearingTextIn+":---°<br>"+this.options.bearingTextOut+":---°"),e+='<div class="polyline-measure-tooltip-difference">+0</div>',e+='<div class="polyline-measure-tooltip-total">0</div>',this._arrPolylines[t].tooltips[0]._icon.innerHTML=e,this._arrPolylines[t].tooltips.map(function(i,e){if(e>=1){var r=this._arrPolylines[t].circleCoords[e-1].distanceTo(this._arrPolylines[t].circleCoords[e]),s=this._arrPolylines[t].circleCoords[e-1],n=this._arrPolylines[t].circleCoords[e];o+=r;var l=this._arrPolylines[t].tooltips[e-1];this._updateTooltip(i,l,o,r,s,n)}}.bind(this)),void this._map.on("mousemove",this._mouseMove,this)}this._currentLine?this._finishPolylinePath(i):this._toggleMeasure()}},_getDistance:function(i){var t,e=i;return"nauticalmiles"===this.options.unit?(t=this.options.unitControlLabel.nauticalmiles,e>=185200?e=(e/1852).toFixed(0):e>=18520?e=(e/1852).toFixed(1):e>=1852?e=(e/1852).toFixed(2):this.options.distanceShowSameUnit?e=(e/1852).toFixed(3):(e=(e/.3048).toFixed(0),t=this.options.unitControlLabel.feet)):"landmiles"===this.options.unit?(t=this.options.unitControlLabel.landmiles,e>=160934.4?e=(e/1609.344).toFixed(0):e>=16093.44?e=(e/1609.344).toFixed(1):e>=1609.344?e=(e/1609.344).toFixed(2):this.options.distanceShowSameUnit?e=(e/1609.344).toFixed(3):(e=(e/.3048).toFixed(0),t=this.options.unitControlLabel.feet)):(t=this.options.unitControlLabel.kilometres,e>=1e5?e=(e/1e3).toFixed(0):e>=1e4?e=(e/1e3).toFixed(1):e>=1e3?e=(e/1e3).toFixed(2):this.options.distanceShowSameUnit?e=(e/1e3).toFixed(3):(e=e.toFixed(0),t=this.options.unitControlLabel.metres)),{value:e,unit:t}},_polylineArc:function(i,t){function e(i){var t=Math.sin((1-i)*l)/Math.sin(l),e=Math.sin(i*l)/Math.sin(l),a=t*Math.cos(o)*Math.cos(r)+e*Math.cos(s)*Math.cos(n),c=t*Math.cos(o)*Math.sin(r)+e*Math.cos(s)*Math.sin(n),h=t*Math.sin(o)+e*Math.sin(s),p=180/Math.PI*Math.atan2(h,Math.sqrt(Math.pow(a,2)+Math.pow(c,2))),_=180/Math.PI*Math.atan2(c,a),u=_-180*r/Math.PI;function m(i){return Math[i>0?"floor":"ceil"](i)}return[p,_-=u<0?360*m((u-180)/360):360*m((u+180)/360)]}var o=i.lat,r=i.lng,s=t.lat,n=t.lng;o=o*Math.PI/180,r=r*Math.PI/180,s=s*Math.PI/180,n=n*Math.PI/180;var l=2*Math.asin(Math.sqrt(Math.pow(Math.sin((o-s)/2),2)+Math.cos(o)*Math.cos(s)*Math.pow(Math.sin((r-n)/2),2)));return 0===l?[[o,r]]:function(i){for(var t=[],o=1/(i-1),r=0;r<i;r++){var s=e(o*r);t.push(s)}return t}(this._arcpoints)},_updateTooltip:function(i,t,e,o,r,s){var n=function(i,t,e){var o=i.lat/180*Math.PI,r=t.lat/180*Math.PI,s=i.lng/180*Math.PI,n=t.lng/180*Math.PI,l=Math.sin(n-s)*Math.cos(r),a=Math.cos(o)*Math.sin(r)-Math.sin(o)*Math.cos(r)*Math.cos(n-s);if("inbound"===e)var c=(180*Math.atan2(l,a)/Math.PI+180).toFixed(0);else c=(180*Math.atan2(l,a)/Math.PI+360).toFixed(0);return c%360},l=n(s,r,"inbound"),a=n(r,s,"outbound"),c=this._getDistance(e),h=this._getDistance(o),p="";if(h.value>0&&(!0===this.options.showBearings&&(p=this.options.bearingTextIn+": "+l+"°<br>"+this.options.bearingTextOut+":---°"),p+='<div class="polyline-measure-tooltip-difference">+'+h.value+"&nbsp;"+h.unit+"</div>"),p+='<div class="polyline-measure-tooltip-total">'+c.value+"&nbsp;"+c.unit+"</div>",i._icon.innerHTML=p,!0===this.options.showBearings&&t){var _=t._icon.innerHTML,u=new RegExp(this.options.bearingTextOut+".*°"),m=_.replace(u,this.options.bearingTextOut+": "+a+"°");t._icon.innerHTML=m}},_drawArrow:function(t){var e=Math.round(t.length/2),o=t[e-1],r=t[e],s=r[1]-o[1],n=r[0]-o[0],l=[o[0]+n/2,o[1]+s/2],a=57.29578*-Math.atan2(n,s),c=i.divIcon({className:"",iconSize:[16,16],iconAnchor:[8,8],html:"<div style = 'font-size: 16px; line-height: 16px; vertical-align:top; transform: rotate("+a+"deg)'>&#x27a4;</div>"}),h=i.marker(l,{icon:c,zIndexOffset:-50}).addTo(this._layerPaint);return this._currentLine||h.bindTooltip(this.options.tooltipTextAdd,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),h.on("click",this._clickedArrow,this),h},_mouseMove:function(i){var t=i.latlng;if(this._map.on("click",this._mouseClick,this),t&&this._currentLine){var e=this._currentLine.circleCoords.last();this._rubberlinePath.setLatLngs(this._polylineArc(e,t));var o=this._currentLine.tooltips.last(),r=this._currentLine.tooltips.slice(-2,-1)[0];o.setLatLng(t);var s=t.distanceTo(e);this._updateTooltip(o,r,this._currentLine.distance+s,s,e,t)}},_startLine:function(t){var e=i.divIcon({className:"polyline-measure-tooltip",iconAnchor:[-4,-4]}),o=function(){return this.slice(-1)[0]};this._rubberlinePath=i.polyline([],{color:this.options.tempLine.color,weight:this.options.tempLine.weight,interactive:!1,dashArray:"8,8"}).addTo(this._layerPaint).bringToBack();var r=this;this._currentLine={id:0,circleCoords:[],circleMarkers:[],arrowMarkers:[],tooltips:[],distance:0,polylinePath:i.polyline([],{color:this.options.fixedLine.color,weight:this.options.fixedLine.weight,interactive:!1}).addTo(this._layerPaint).bringToBack(),handleMarkers:function(t){var e=this.circleMarkers.last();e&&(e.bindTooltip(r.options.tooltipTextDelete,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),e.off("click",r._finishPolylinePath,r),1===this.circleMarkers.length?e.setStyle(r.options.startCircle):e.setStyle(r.options.intermedCircle));var o=new i.CircleMarker(t,r.options.currentCircle).addTo(r._layerPaint);o.bindTooltip(r.options.tooltipTextFinish+r.options.tooltipTextDelete,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),o.cntLine=r._currentLine.id,o.cntCircle=r._cntCircle,r._cntCircle++,o.on("mousedown",r._dragCircle,r),o.on("click",r._finishPolylinePath,r),this.circleMarkers.push(o)},getNewToolTip:function(t){return i.marker(t,{icon:e,interactive:!1})},addPoint:function(i){var t=this.circleCoords.last();if(!t||!t.equals(i)){if(this.circleCoords.push(i),this.circleCoords.length>1){var e=r._polylineArc(t,i);this.circleCoords.length>2&&e.shift(),this.polylinePath.setLatLngs(this.polylinePath.getLatLngs().concat(e));var o=r._drawArrow(e);o.cntLine=r._currentLine.id,o.cntArrow=r._cntCircle-1,r._currentLine.arrowMarkers.push(o);var s=t.distanceTo(i);this.distance+=s;var n=r._currentLine.tooltips.last(),l=r._currentLine.tooltips.slice(-1,-2)[0];r._updateTooltip(n,l,this.distance,s,t,i)}n&&n.setLatLng(i);var a=this.getNewToolTip(i);a.addTo(r._layerPaint),this.tooltips.push(a),this.handleMarkers(i)}},finalize:function(){if(r._layerPaint.removeLayer(this.tooltips.last()),this.tooltips.pop(),r._layerPaint.removeLayer(r._rubberlinePath),this.circleCoords.length>1){this.tooltips.last()._icon.classList.add("polyline-measure-tooltip-end");var i=this.circleMarkers.last();i.setStyle(r.options.endCircle),i.unbindTooltip(),r._currentLine.circleMarkers.map((function(i){i.bindTooltip(r.options.tooltipTextMove+r.options.tooltipTextDelete,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"})})),r._currentLine.circleMarkers[0].bindTooltip(r.options.tooltipTextMove+r.options.tooltipTextDelete+r.options.tooltipTextResume,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),i.bindTooltip(r.options.tooltipTextMove+r.options.tooltipTextDelete+r.options.tooltipTextResume,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),r._currentLine.arrowMarkers.map((function(i){i.bindTooltip(r.options.tooltipTextAdd,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"})})),i.off("click",r._finishPolylinePath,r),i.on("click",r._resumePolylinePath,r),r._arrPolylines.push(this)}else r._layerPaint.removeLayer(this.circleMarkers.last()),r._layerPaint.removeLayer(this.tooltips.last());r._resetPathVariables()}};var s=i.marker(t,{icon:e,interactive:!1});s.addTo(this._layerPaint);var n="";!0===this.options.showBearings&&(n=this.options.bearingTextIn+":---°<br>"+this.options.bearingTextOut+":---°"),n+='<div class="polyline-measure-tooltip-difference">+0</div>',n+='<div class="polyline-measure-tooltip-total">0</div>',s._icon.innerHTML=n,this._currentLine.tooltips.push(s),this._currentLine.circleCoords.last=o,this._currentLine.tooltips.last=o,this._currentLine.circleMarkers.last=o,this._currentLine.id=this._arrPolylines.length},_mouseClick:function(i){!i.latlng||this._finishCircleScreencoords&&this._finishCircleScreencoords.equals(i.containerPoint)||(this._currentLine||this._mapdragging||(this._startLine(i.latlng),this._map.fire("polylinemeasure:start",this._currentLine)),this._mapdragging?this._mapdragging=!1:(this._currentLine.addPoint(i.latlng),this._map.fire("polylinemeasure:add",i),this._map.fire("polylinemeasure:change",this._currentLine)))},_finishPolylinePath:function(i){this._map.fire("polylinemeasure:finish",this._currentLine),this._currentLine.finalize(),i&&(this._finishCircleScreencoords=i.containerPoint)},_resumePolylinePath:function(t){if(!0===t.originalEvent.ctrlKey){this._currentLine=this._arrPolylines[t.target.cntLine],this._rubberlinePath=i.polyline([],{color:this.options.tempLine.color,weight:this.options.tempLine.weight,interactive:!1,dashArray:"8,8"}).addTo(this._layerPaint).bringToBack(),this._currentLine.tooltips.last()._icon.classList.remove("polyline-measure-tooltip-end");var e=this._currentLine.getNewToolTip(t.latlng);e.addTo(this._layerPaint),this._currentLine.tooltips.push(e),this._currentLine.circleMarkers.last().unbindTooltip(),this._currentLine.circleMarkers.last().bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),this._currentLine.circleMarkers.last().setStyle(this.options.currentCircle),this._cntCircle=this._currentLine.circleCoords.length,this._map.fire("polylinemeasure:resume",this._currentLine)}},_resetPathVariables:function(){this._cntCircle=0,this._currentLine=null},_clickedArrow:function(t){if(t.originalEvent.ctrlKey){var e=t.target.cntLine,o=t.target.cntArrow;this._arrPolylines[e].arrowMarkers[o].removeFrom(this._layerPaint);var r=new i.CircleMarker(t.latlng,this.options.intermedCircle).addTo(this._layerPaint);r.cntLine=e,r.on("mousedown",this._dragCircle,this),r.bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),this._arrPolylines[e].circleMarkers.splice(o+1,0,r),this._arrPolylines[e].circleMarkers.map((function(i,t){i.cntCircle=t})),this._arrPolylines[e].circleCoords.splice(o+1,0,t.latlng),lineCoords=this._arrPolylines[e].polylinePath.getLatLngs();var s=this._polylineArc(this._arrPolylines[e].circleCoords[o],t.latlng);s.pop();var n=this._polylineArc(t.latlng,this._arrPolylines[e].circleCoords[o+2]);Array.prototype.splice.apply(lineCoords,[o*(this._arcpoints-1),this._arcpoints].concat(s,n)),this._arrPolylines[e].polylinePath.setLatLngs(lineCoords);var l=this._drawArrow(s);this._arrPolylines[e].arrowMarkers[o]=l,l=this._drawArrow(n),this._arrPolylines[e].arrowMarkers.splice(o+1,0,l),this._arrPolylines[e].arrowMarkers.map((function(i,t){i.cntLine=e,i.cntArrow=t})),this._tooltipNew=i.marker(t.latlng,{icon:i.divIcon({className:"polyline-measure-tooltip",iconAnchor:[-4,-4]}),interactive:!1}),this._tooltipNew.addTo(this._layerPaint),this._arrPolylines[e].tooltips.splice(o+1,0,this._tooltipNew);var a=0;this._arrPolylines[e].tooltips.map(function(i,t){if(t>=1){var o=this._arrPolylines[e].circleCoords[t-1].distanceTo(this._arrPolylines[e].circleCoords[t]),r=this._arrPolylines[e].circleCoords[t-1],s=this._arrPolylines[e].circleCoords[t];a+=o;var n=this._arrPolylines[e].tooltips[t-1];this._updateTooltip(i,n,a,o,r,s)}}.bind(this)),this._map.fire("polylinemeasure:insert",t),this._map.fire("polylinemeasure:change",this._arrPolylines[this._lineNr])}},_dragCircleMouseup:function(){0===this._circleNr||this._circleNr===this._arrPolylines[this._lineNr].circleCoords.length-1?this._e1.target.bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete+this.options.tooltipTextResume,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}):this._e1.target.bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),this._resetPathVariables(),this._map.off("mousemove",this._dragCircleMousemove,this),this._map.dragging.enable(),this._map.on("mousemove",this._mouseMove,this),this._map.off("mouseup",this._dragCircleMouseup,this),this._map.fire("polylinemeasure:move",this._e1),this._map.fire("polylinemeasure:change",this._arrPolylines[this._lineNr])},_dragCircleMousemove:function(t){var e=t.latlng.lat,o=t.latlng.lng,r=e-this._mouseStartingLat,s=o-this._mouseStartingLng,n=i.latLng(this._circleStartingLat+r,this._circleStartingLng+s),l=this._arcpoints,a=this._e1.target.cntLine;this._lineNr=a;var c=this._e1.target.cntCircle;this._circleNr=c,this._e1.target.setLatLng(n),this._e1.target.unbindTooltip(),this._arrPolylines[a].circleCoords[c]=n;var h=this._arrPolylines[a].polylinePath.getLatLngs();if(c>=1){var p=this._polylineArc(this._arrPolylines[a].circleCoords[c-1],n);Array.prototype.splice.apply(h,[(c-1)*(l-1),l].concat(p));var _=this._drawArrow(p);_.cntLine=a,_.cntArrow=c-1,this._arrPolylines[a].arrowMarkers[c-1].removeFrom(this._layerPaint),this._arrPolylines[a].arrowMarkers[c-1]=_}if(c<this._arrPolylines[a].circleCoords.length-1){var u=this._polylineArc(n,this._arrPolylines[a].circleCoords[c+1]);Array.prototype.splice.apply(h,[c*(l-1),l].concat(u)),(_=this._drawArrow(u)).cntLine=a,_.cntArrow=c,this._arrPolylines[a].arrowMarkers[c].removeFrom(this._layerPaint),this._arrPolylines[a].arrowMarkers[c]=_}this._arrPolylines[a].polylinePath.setLatLngs(h),c>=0&&this._arrPolylines[a].tooltips[c].setLatLng(n);var m=0;this._arrPolylines[a].tooltips.map(function(i,t){if(t>=1){var e=this._arrPolylines[a].circleCoords[t-1].distanceTo(this._arrPolylines[a].circleCoords[t]),o=this._arrPolylines[a].circleCoords[t-1],r=this._arrPolylines[a].circleCoords[t];m+=e,this._arrPolylines[a].distance=m;var s=this._arrPolylines[a].tooltips[t-1];this._updateTooltip(i,s,m,e,o,r)}}.bind(this)),this._map.on("mouseup",this._dragCircleMouseup,this)},_resumeFirstpointMousemove:function(i){var t=this._lineNr;this._map.on("click",this._resumeFirstpointClick,this);var e=i.latlng;this._rubberlinePath2.setLatLngs(this._polylineArc(e,currentCircleCoords)),this._tooltipNew.setLatLng(e);var o=0,r=e.distanceTo(this._arrPolylines[t].circleCoords[0]),s=e,n=this._arrPolylines[t].circleCoords[0];o+=r;var l=this._tooltipNew,a=this._arrPolylines[t].tooltips[0];this._updateTooltip(a,l,o,r,s,n),this._arrPolylines[t].tooltips.map(function(i,e){if(e>=1){var r=this._arrPolylines[t].circleCoords[e-1].distanceTo(this._arrPolylines[t].circleCoords[e]),s=this._arrPolylines[t].circleCoords[e-1],n=this._arrPolylines[t].circleCoords[e];o+=r;var l=this._arrPolylines[t].tooltips[e-1];this._updateTooltip(i,l,o,r,s,n)}}.bind(this))},_resumeFirstpointClick:function(t){var e=this._lineNr;this._resumeFirstpointFlag=!1,this._map.off("mousemove",this._resumeFirstpointMousemove,this),this._map.off("click",this._resumeFirstpointClick,this),this._layerPaint.removeLayer(this._rubberlinePath2),this._arrPolylines[e].circleMarkers[0].setStyle(this.options.intermedCircle),this._arrPolylines[e].circleMarkers[0].unbindTooltip(),this._arrPolylines[e].circleMarkers[0].bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"});var o=new i.CircleMarker(t.latlng,this.options.startCircle).addTo(this._layerPaint);o.cntLine=e,o.cntCircle=0,o.on("mousedown",this._dragCircle,this),o.bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete+this.options.tooltipTextResume,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),this._arrPolylines[e].circleMarkers.unshift(o),this._arrPolylines[e].circleMarkers.map((function(i,t){i.cntCircle=t})),this._arrPolylines[e].circleCoords.unshift(t.latlng);var r=this._polylineArc(t.latlng,currentCircleCoords),s=this._drawArrow(r);this._arrPolylines[e].arrowMarkers.unshift(s),this._arrPolylines[e].arrowMarkers.map((function(i,t){i.cntLine=e,i.cntArrow=t})),r.pop(),this._arrPolylines[e].polylinePath.setLatLngs(r.concat(this._arrPolylines[e].polylinePath.getLatLngs())),this._arrPolylines[e].tooltips.unshift(this._tooltipNew),this._map.on("mousemove",this._mouseMove,this)},_dragCircle:function(t){var e=this._arcpoints;if(t.originalEvent.ctrlKey){if(this._map.off("click",this._mouseClick,this),0===t.target.cntCircle){this._resumeFirstpointFlag=!0,this._lineNr=t.target.cntLine;var o=this._lineNr;this._circleNr=t.target.cntCircle,currentCircleCoords=t.latlng,this._arrPolylines[o].circleMarkers[0].setStyle(this.options.currentCircle),this._rubberlinePath2=i.polyline([],{color:this.options.tempLine.color,weight:this.options.tempLine.weight,interactive:!1,dashArray:"8,8"}).addTo(this._layerPaint).bringToBack(),this._tooltipNew=i.marker(currentCircleCoords,{icon:i.divIcon({className:"polyline-measure-tooltip",iconAnchor:[-4,-4]}),interactive:!1}),this._tooltipNew.addTo(this._layerPaint);var r="";!0===this.options.showBearings&&(r=r+this.options.bearingTextIn+":---°<br>"+this.options.bearingTextOut+":---°"),r+='<div class="polyline-measure-tooltip-difference">+0</div>',r+='<div class="polyline-measure-tooltip-total">0</div>',this._tooltipNew._icon.innerHTML=r,this._map.off("mousemove",this._mouseMove,this),this._map.on("mousemove",this._resumeFirstpointMousemove,this)}}else{if(t.originalEvent.shiftKey){this._lineNr=t.target.cntLine;o=this._lineNr;this._circleNr=t.target.cntCircle;var s=this._circleNr;if(this._arrPolylines[o]){if(2===this._arrPolylines[o].circleMarkers.length)return this._layerPaint.removeLayer(this._arrPolylines[o].circleMarkers[1]),this._layerPaint.removeLayer(this._arrPolylines[o].tooltips[1]),this._layerPaint.removeLayer(this._arrPolylines[o].circleMarkers[0]),this._layerPaint.removeLayer(this._arrPolylines[o].tooltips[0]),this._layerPaint.removeLayer(this._arrPolylines[o].arrowMarkers[0]),this._layerPaint.removeLayer(this._arrPolylines[o].polylinePath),this._map.fire("polylinemeasure:remove",t),void this._map.fire("polylinemeasure:change",this._arrPolylines[this._lineNr]);this._arrPolylines[o].circleCoords.splice(s,1),this._arrPolylines[o].circleMarkers[s].removeFrom(this._layerPaint),this._arrPolylines[o].circleMarkers.splice(s,1),this._arrPolylines[o].circleMarkers.map((function(i,t){i.cntCircle=t}));var n=this._arrPolylines[o].polylinePath.getLatLngs();if(this._arrPolylines[o].tooltips[s].removeFrom(this._layerPaint),this._arrPolylines[o].tooltips.splice(s,1),!this._arrPolylines[o].circleMarkers.length)return this._arrPolylines.splice(o,1),void this._arrPolylines.forEach((function(i,t){i.circleMarkers.map((function(i){i.cntLine=t})),i.arrowMarkers.map((function(i){i.cntLine=t}))}));if(0===s){this._arrPolylines[o].circleMarkers[0].setStyle(this.options.startCircle),n.splice(0,e-1),this._arrPolylines[o].circleMarkers[0].bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete+this.options.tooltipTextResume,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),this._arrPolylines[o].arrowMarkers[s].removeFrom(this._layerPaint),this._arrPolylines[o].arrowMarkers.splice(0,1);r="";!0===this.options.showBearings&&(r=this.options.bearingTextIn+":---°<br>"+this.options.bearingTextOut+":---°"),r+='<div class="polyline-measure-tooltip-difference">+0</div>',r+='<div class="polyline-measure-tooltip-total">0</div>',this._arrPolylines[o].tooltips[0]._icon.innerHTML=r}else if(s===this._arrPolylines[o].circleCoords.length)this._arrPolylines[o].circleMarkers[s-1].on("click",this._resumePolylinePath,this),this._arrPolylines[o].circleMarkers[s-1].bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete+this.options.tooltipTextResume,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),this._arrPolylines[o].circleMarkers.slice(-1)[0].setStyle(this.options.endCircle),this._arrPolylines[o].tooltips.slice(-1)[0]._icon.classList.add("polyline-measure-tooltip-end"),n.splice(-(e-1),e-1),this._arrPolylines[o].arrowMarkers[s-1].removeFrom(this._layerPaint),this._arrPolylines[o].arrowMarkers.splice(-1,1);else{newLineSegment=this._polylineArc(this._arrPolylines[o].circleCoords[s-1],this._arrPolylines[o].circleCoords[s]),Array.prototype.splice.apply(n,[(s-1)*(e-1),2*e-1].concat(newLineSegment)),this._arrPolylines[o].arrowMarkers[s-1].removeFrom(this._layerPaint),this._arrPolylines[o].arrowMarkers[s].removeFrom(this._layerPaint);var l=this._drawArrow(newLineSegment);this._arrPolylines[o].arrowMarkers.splice(s-1,2,l)}this._arrPolylines[o].polylinePath.setLatLngs(n),this._arrPolylines[o].arrowMarkers.map((function(i,t){i.cntLine=o,i.cntArrow=t}));var a=0;this._arrPolylines[o].tooltips.map(function(i,t){if(t>=1){var e=this._arrPolylines[o].circleCoords[t-1].distanceTo(this._arrPolylines[o].circleCoords[t]),r=this._arrPolylines[o].circleCoords[t-1],s=this._arrPolylines[o].circleCoords[t];a+=e,this._arrPolylines[o].distance=a;var n=this._arrPolylines[o].tooltips[t-1];this._updateTooltip(i,n,a,e,r,s)}}.bind(this))}else{if(this._cntCircle--,1===this._currentLine.circleMarkers.length)return void this._currentLine.finalize();if(this._currentLine.circleCoords.splice(s,1),this._currentLine.circleMarkers[s].removeFrom(this._layerPaint),this._currentLine.circleMarkers.splice(s,1),this._currentLine.circleMarkers.map((function(i,t){i.cntCircle=t})),n=this._currentLine.polylinePath.getLatLngs(),this._currentLine.tooltips[s].removeFrom(this._layerPaint),this._currentLine.tooltips.splice(s,1),0===s){1===this._currentLine.circleMarkers.length?this._currentLine.circleMarkers[0].setStyle(this.options.currentCircle):this._currentLine.circleMarkers[0].setStyle(this.options.startCircle),n.splice(0,e-1),this._currentLine.circleMarkers[0].bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete+this.options.tooltipTextResume,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),this._currentLine.arrowMarkers[s].removeFrom(this._layerPaint),this._currentLine.arrowMarkers.splice(0,1);r="";!0===this.options.showBearings&&(r=this.options.bearingTextIn+":---°<br>"+this.options.bearingTextOut+":---°"),r+='<div class="polyline-measure-tooltip-difference">+0</div>',r+='<div class="polyline-measure-tooltip-total">0</div>',this._currentLine.tooltips[0]._icon.innerHTML=r}else s===this._currentLine.circleCoords.length?(this._currentLine.circleMarkers[s-1].on("click",this._resumePolylinePath,this),this._currentLine.circleMarkers[s-1].bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete+this.options.tooltipTextResume,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),this._currentLine.circleMarkers.slice(-1)[0].setStyle(this.options.currentCircle),this._currentLine.tooltips.slice(-1)[0]._icon.classList.add("polyline-measure-tooltip-end"),n.splice(-(e-1),e-1),this._currentLine.arrowMarkers[s-1].removeFrom(this._layerPaint),this._currentLine.arrowMarkers.splice(-1,1)):(newLineSegment=this._polylineArc(this._currentLine.circleCoords[s-1],this._currentLine.circleCoords[s]),Array.prototype.splice.apply(n,[(s-1)*(e-1),2*e-1].concat(newLineSegment)),this._currentLine.arrowMarkers[s-1].removeFrom(this._layerPaint),this._currentLine.arrowMarkers[s].removeFrom(this._layerPaint),l=this._drawArrow(newLineSegment),this._currentLine.arrowMarkers.splice(s-1,2,l));this._currentLine.polylinePath.setLatLngs(n),this._currentLine.arrowMarkers.map((function(i,t){i.cntLine=o,i.cntArrow=t}));var c=0;this._currentLine.tooltips.map(function(i,e,o){if(e>=1){var r,s,n=this._currentLine.tooltips[e-1],l=this._currentLine.circleCoords[e-1];e===o.length-1?(r=this._currentLine.circleCoords[e-1].distanceTo(t.latlng),s=t.latlng,this._updateTooltip(i,n,c+r,r,l,s)):(r=this._currentLine.circleCoords[e-1].distanceTo(this._currentLine.circleCoords[e]),s=this._currentLine.circleCoords[e],c+=r,this._updateTooltip(i,n,c,r,l,s))}}.bind(this)),this._currentLine.distance=c}return this._map.fire("polylinemeasure:remove",t),void this._map.fire("polylinemeasure:change",this._arrPolylines[this._lineNr])}this._e1=t,this._measuring&&0===this._cntCircle&&(this._map.dragging.disable(),this._map.off("mousemove",this._mouseMove,this),this._map.off("click",this._mouseClick,this),this._mouseStartingLat=t.latlng.lat,this._mouseStartingLng=t.latlng.lng,this._circleStartingLat=t.target._latlng.lat,this._circleStartingLng=t.target._latlng.lng,this._map.on("mousemove",this._dragCircleMousemove,this))}},seed:function(t){t.forEach((t=>{this._toggleMeasure(),this._startLine(t[0]),t.forEach(((e,o)=>{const r=i.latLng(e);this._mouseMove({latLng:r}),this._currentLine.addPoint(r),o===t.length-1&&(this._finishPolylinePath(),this._toggleMeasure())}))}))}}),i.Map.mergeOptions({PolylineMeasureControl:!1}),i.Map.addInitHook((function(){this.options.polylineMeasureControl&&(this.PMControl=new i.Control.PolylineMeasure,this.addControl(this.PMControl))})),i.control.polylineMeasure=function(t){return new i.Control.PolylineMeasure(t)},i.Control.PolylineMeasure}));
//# sourceMappingURL=/sm/18e6a29b2d7b588727351ee4c1083b048ee64e9a4ee208ec545ececed416b71a.map