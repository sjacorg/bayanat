/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.39.0.
 * Original file: /npm/jsondiffpatch@0.7.3/lib/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
function t(t,e){var i,n,r,s,o,l;if("string"!=typeof e)return e;const c=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d*))?(Z|([+-])(\d{2}):(\d{2}))$/.exec(e);return c?new Date(Date.UTC(Number.parseInt(null!==(i=c[1])&&void 0!==i?i:"0",10),Number.parseInt(null!==(n=c[2])&&void 0!==n?n:"0",10)-1,Number.parseInt(null!==(r=c[3])&&void 0!==r?r:"0",10),Number.parseInt(null!==(s=c[4])&&void 0!==s?s:"0",10),Number.parseInt(null!==(o=c[5])&&void 0!==o?o:"0",10),Number.parseInt(null!==(l=c[6])&&void 0!==l?l:"0",10),(c[7]?Number.parseInt(c[7]):0)||0)):e}function e(t){if("object"!=typeof t)return t;if(null===t)return null;if(Array.isArray(t))return t.map(e);if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp)return function(t){var e;const i=/^\/(.*)\/([gimyu]*)$/.exec(t.toString());if(!i)throw new Error("Invalid RegExp");return new RegExp(null!==(e=i[1])&&void 0!==e?e:"",i[2])}(t);const i={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=e(t[n]));return i}class i{setResult(t){return this.result=t,this.hasResult=!0,this}exit(){return this.exiting=!0,this}push(t,e){var i;return t.parent=this,void 0!==e&&(t.childName=e),t.root=this.root||this,t.options=t.options||this.options,this.children?(!function(t,e){if(0===t.length)throw new Error(e||"Expected a non-empty array")}(this.children),(i=this.children,i[i.length-1]).next=t,this.children.push(t)):(this.children=[t],this.nextAfterChildren=this.next||null,this.next=t),t.next=this,this}}class n extends i{constructor(t,e){super(),this.left=t,this.right=e,this.pipe="diff"}prepareDeltaResult(t){var i,n,r,s;if("object"==typeof t&&((null===(i=this.options)||void 0===i?void 0:i.omitRemovedValues)&&Array.isArray(t)&&t.length>1&&(2===t.length||0===t[2]||3===t[2])&&(t[0]=0),null===(n=this.options)||void 0===n?void 0:n.cloneDiffValues)){const i="function"==typeof(null===(r=this.options)||void 0===r?void 0:r.cloneDiffValues)?null===(s=this.options)||void 0===s?void 0:s.cloneDiffValues:e;"object"==typeof t[0]&&(t[0]=i(t[0])),"object"==typeof t[1]&&(t[1]=i(t[1]))}return t}setResult(t){return this.prepareDeltaResult(t),super.setResult(t)}}class r extends i{constructor(t,e){super(),this.left=t,this.delta=e,this.pipe="patch"}}class s extends i{constructor(t){super(),this.delta=t,this.pipe="reverse"}}class o{constructor(t){this.name=t,this.filters=[]}process(t){if(!this.processor)throw new Error("add this pipe to a processor before using it");const e=this.debug,i=this.filters.length,n=t;for(let t=0;t<i;t++){const i=this.filters[t];if(i&&(e&&this.log(`filter: ${i.filterName}`),i(n),"object"==typeof n&&n.exiting)){n.exiting=!1;break}}!n.next&&this.resultCheck&&this.resultCheck(n)}log(t){console.log(`[jsondiffpatch] ${this.name} pipe, ${t}`)}append(...t){return this.filters.push(...t),this}prepend(...t){return this.filters.unshift(...t),this}indexOf(t){if(!t)throw new Error("a filter name is required");for(let e=0;e<this.filters.length;e++){const i=this.filters[e];if((null==i?void 0:i.filterName)===t)return e}throw new Error(`filter not found: ${t}`)}list(){return this.filters.map((t=>t.filterName))}after(t,...e){const i=this.indexOf(t);return this.filters.splice(i+1,0,...e),this}before(t,...e){const i=this.indexOf(t);return this.filters.splice(i,0,...e),this}replace(t,...e){const i=this.indexOf(t);return this.filters.splice(i,1,...e),this}remove(t){const e=this.indexOf(t);return this.filters.splice(e,1),this}clear(){return this.filters.length=0,this}shouldHaveResult(t){return!1===t?(this.resultCheck=null,this):(this.resultCheck||(this.resultCheck=t=>{if(!t.hasResult){console.log(t);const e=new Error(`${this.name} failed`);throw e.noResult=!0,e}}),this)}}class l{constructor(t){this.selfOptions=t||{},this.pipes={}}options(t){return t&&(this.selfOptions=t),this.selfOptions}pipe(t,e){let i=e;if("string"==typeof t){if(void 0===i)return this.pipes[t];this.pipes[t]=i}if(t&&t.name){if(i=t,i.processor===this)return i;this.pipes[i.name]=i}if(!i)throw new Error(`pipe is not defined: ${t}`);return i.processor=this,i}process(t,e){let i=t;i.options=this.options();let n,r=e||t.pipe||"default";for(;r;)void 0!==i.nextAfterChildren&&(i.next=i.nextAfterChildren,i.nextAfterChildren=null),"string"==typeof r&&(r=this.pipe(r)),r.process(i),n=r,r=null,i&&i.next&&(i=i.next,r=i.pipe||n);return i.hasResult?i.result:void 0}}const c=(t,e,i,n)=>t[i]===e[n];var f=(t,e,i,n)=>{const r=n||{},s=((t,e,i,n)=>{var r,s,o;const l=t.length,c=e.length;let f,u;const h=new Array(l+1);for(f=0;f<l+1;f++){const t=new Array(c+1);for(u=0;u<c+1;u++)t[u]=0;h[f]=t}for(h.match=i,f=1;f<l+1;f++){const l=h[f];if(void 0===l)throw new Error("LCS matrix row is undefined");const a=h[f-1];if(void 0===a)throw new Error("LCS matrix row is undefined");for(u=1;u<c+1;u++)i(t,e,f-1,u-1,n)?l[u]=(null!==(r=a[u-1])&&void 0!==r?r:0)+1:l[u]=Math.max(null!==(s=a[u])&&void 0!==s?s:0,null!==(o=l[u-1])&&void 0!==o?o:0)}return h})(t,e,i||c,r);return((t,e,i,n)=>{let r=e.length,s=i.length;const o={sequence:[],indices1:[],indices2:[]};for(;0!==r&&0!==s;){if(void 0===t.match)throw new Error("LCS matrix match function is undefined");if(t.match(e,i,r-1,s-1,n))o.sequence.unshift(e[r-1]),o.indices1.unshift(r-1),o.indices2.unshift(s-1),--r,--s;else{const e=t[r];if(void 0===e)throw new Error("LCS matrix row is undefined");const i=e[s-1];if(void 0===i)throw new Error("LCS matrix value is undefined");const n=t[r-1];if(void 0===n)throw new Error("LCS matrix row is undefined");const o=n[s];if(void 0===o)throw new Error("LCS matrix value is undefined");i>o?--s:--r}}return o})(s,t,e,r)};function u(t,e,i,n,r){const s=t[i],o=e[n];if(s===o)return!0;if("object"!=typeof s||"object"!=typeof o)return!1;const l=r.objectHash;if(!l)return r.matchByPosition&&i===n;r.hashCache1=r.hashCache1||[];let c=r.hashCache1[i];if(void 0===c&&(r.hashCache1[i]=c=l(s,i)),void 0===c)return!1;r.hashCache2=r.hashCache2||[];let f=r.hashCache2[n];return void 0===f&&(r.hashCache2[n]=f=l(o,n)),void 0!==f&&c===f}const h=function(t){var e,i,r,s,o;if(!t.leftIsArray)return;const l={objectHash:null===(e=t.options)||void 0===e?void 0:e.objectHash,matchByPosition:null===(i=t.options)||void 0===i?void 0:i.matchByPosition};let c,h,a,d=0,p=0;const v=t.left,x=t.right,g=v.length,m=x.length;let y,w;for(g>0&&m>0&&!l.objectHash&&"boolean"!=typeof l.matchByPosition&&(l.matchByPosition=!function(t,e,i,n){for(let r=0;r<i;r++){const i=t[r];for(let t=0;t<n;t++){const n=e[t];if(r!==t&&i===n)return!0}}return!1}(v,x,g,m));d<g&&d<m&&u(v,x,d,d,l);)c=d,y=new n(v[c],x[c]),t.push(y,c),d++;for(;p+d<g&&p+d<m&&u(v,x,g-1-p,m-1-p,l);)h=g-1-p,a=m-1-p,y=new n(v[h],x[a]),t.push(y,a),p++;if(d+p===g){if(g===m)return void t.setResult(void 0).exit();for(w=w||{_t:"a"},c=d;c<m-p;c++)w[c]=[x[c]],t.prepareDeltaResult(w[c]);return void t.setResult(w).exit()}if(d+p===m){for(w=w||{_t:"a"},c=d;c<g-p;c++){const e=`_${c}`;w[e]=[v[c],0,0],t.prepareDeltaResult(w[e])}return void t.setResult(w).exit()}l.hashCache1=void 0,l.hashCache2=void 0;const R=v.slice(d,g-p),b=x.slice(d,m-p),N=f(R,b,u,l),C=[];for(w=w||{_t:"a"},c=d;c<g-p;c++)if(N.indices1.indexOf(c-d)<0){const e=`_${c}`;w[e]=[v[c],0,0],t.prepareDeltaResult(w[e]),C.push(c)}let A=!0;(null===(r=t.options)||void 0===r?void 0:r.arrays)&&!1===t.options.arrays.detectMove&&(A=!1);let E=!1;(null===(o=null===(s=t.options)||void 0===s?void 0:s.arrays)||void 0===o?void 0:o.includeValueOnMove)&&(E=!0);const _=C.length;for(c=d;c<m-p;c++){const e=N.indices2.indexOf(c-d);if(e<0){let e=!1;if(A&&_>0)for(let i=0;i<_;i++){h=C[i];const r=void 0===h?void 0:w[`_${h}`];if(void 0!==h&&r&&u(R,b,h-d,c-d,l)){r.splice(1,2,c,3),r.splice(1,2,c,3),E||(r[0]=""),a=c,y=new n(v[h],x[a]),t.push(y,a),C.splice(i,1),e=!0;break}}e||(w[c]=[x[c]],t.prepareDeltaResult(w[c]))}else{if(void 0===N.indices1[e])throw new Error(`Invalid indexOnArray2: ${e}, seq.indices1: ${N.indices1}`);if(h=N.indices1[e]+d,void 0===N.indices2[e])throw new Error(`Invalid indexOnArray2: ${e}, seq.indices2: ${N.indices2}`);a=N.indices2[e]+d,y=new n(v[h],x[a]),t.push(y,a)}}t.setResult(w).exit()};h.filterName="arrays";const a={numerically:(t,e)=>t-e,numericallyBy:t=>(e,i)=>e[t]-i[t]},d=function(t){var e;if(!t.nested)return;const i=t.delta;if("a"!==i._t)return;let n,s;const o=i,l=t.left;let c=[],f=[];const u=[];for(n in o)if("_t"!==n)if("_"===n[0]){const t=n;if(void 0===o[t]||0!==o[t][2]&&3!==o[t][2])throw new Error(`only removal or move can be applied at original array indices, invalid diff type: ${null===(e=o[t])||void 0===e?void 0:e[2]}`);c.push(Number.parseInt(n.slice(1),10))}else{const t=n;1===o[t].length?f.push({index:Number.parseInt(t,10),value:o[t][0]}):u.push({index:Number.parseInt(t,10),delta:o[t]})}for(c=c.sort(a.numerically),n=c.length-1;n>=0;n--){if(s=c[n],void 0===s)continue;const t=o[`_${s}`],e=l.splice(s,1)[0];3===(null==t?void 0:t[2])&&f.push({index:t[1],value:e})}f=f.sort(a.numericallyBy("index"));const h=f.length;for(n=0;n<h;n++){const t=f[n];void 0!==t&&l.splice(t.index,0,t.value)}const d=u.length;if(d>0)for(n=0;n<d;n++){const e=u[n];if(void 0===e)continue;const i=new r(l[e.index],e.delta);t.push(i,e.index)}t.children?t.exit():t.setResult(l).exit()};d.filterName="arrays";const p=function(t){if(!t||!t.children)return;if("a"!==t.delta._t)return;const e=t.left,i=t.children.length;for(let n=0;n<i;n++){const i=t.children[n];if(void 0===i)continue;e[i.childName]=i.result}t.setResult(e).exit()};p.filterName="arraysCollectChildren";const v=function(t){if(!t.nested){const e=t.delta;if(3===e[2]){const i=e;t.newName=`_${i[1]}`,t.setResult([i[0],Number.parseInt(t.childName.substring(1),10),3]).exit()}return}const e=t.delta;if("a"!==e._t)return;const i=e;for(const e in i){if("_t"===e)continue;const n=new s(i[e]);t.push(n,e)}t.exit()};v.filterName="arrays";const x=(t,e,i)=>{if("string"==typeof e&&"_"===e[0])return Number.parseInt(e.substring(1),10);if(Array.isArray(i)&&0===i[2])return`_${e}`;let n=+e;for(const i in t){const r=t[i];if(Array.isArray(r))if(3===r[2]){const t=Number.parseInt(i.substring(1),10),s=r[1];if(s===+e)return t;t<=n&&s>n?n++:t>=n&&s<n&&n--}else if(0===r[2]){Number.parseInt(i.substring(1),10)<=n&&n++}else 1===r.length&&Number.parseInt(i,10)<=n&&n--}return n},g=t=>{if(!t||!t.children)return;const e=t.delta;if("a"!==e._t)return;const i=e,n=t.children.length,r={_t:"a"};for(let e=0;e<n;e++){const n=t.children[e];if(void 0===n)continue;let s=n.newName;if(void 0===s){if(void 0===n.childName)throw new Error("child.childName is undefined");s=x(i,n.childName,n.result)}r[s]!==n.result&&(r[s]=n.result)}t.setResult(r).exit()};g.filterName="arraysCollectChildren";const m=function(t){t.left instanceof Date?(t.right instanceof Date?t.left.getTime()!==t.right.getTime()?t.setResult([t.left,t.right]):t.setResult(void 0):t.setResult([t.left,t.right]),t.exit()):t.right instanceof Date&&t.setResult([t.left,t.right]).exit()};m.filterName="dates";const y=t=>{if(!t||!t.children)return;const e=t.children.length;let i=t.result;for(let n=0;n<e;n++){const e=t.children[n];if(void 0!==e&&void 0!==e.result){if(i=i||{},void 0===e.childName)throw new Error("diff child.childName is undefined");i[e.childName]=e.result}}i&&t.leftIsArray&&(i._t="a"),t.setResult(i).exit()};y.filterName="collectChildren";const w=t=>{var e;if(t.leftIsArray||"object"!==t.leftType)return;const i=t.left,r=t.right,s=null===(e=t.options)||void 0===e?void 0:e.propertyFilter;for(const e in i){if(!Object.prototype.hasOwnProperty.call(i,e))continue;if(s&&!s(e,t))continue;const o=new n(i[e],r[e]);t.push(o,e)}for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e)&&(!s||s(e,t))&&void 0===i[e]){const i=new n(void 0,r[e]);t.push(i,e)}t.children&&0!==t.children.length?t.exit():t.setResult(void 0).exit()};w.filterName="objects";const R=function(t){if(!t.nested)return;const e=t.delta;if(e._t)return;const i=e;for(const e in i){const n=new r(t.left[e],i[e]);t.push(n,e)}t.exit()};R.filterName="objects";const b=function(t){if(!t||!t.children)return;if(t.delta._t)return;const e=t.left,i=t.children.length;for(let n=0;n<i;n++){const i=t.children[n];if(void 0===i)continue;const r=i.childName;Object.prototype.hasOwnProperty.call(t.left,r)&&void 0===i.result?delete e[r]:e[r]!==i.result&&(e[r]=i.result)}t.setResult(e).exit()};b.filterName="collectChildren";const N=function(t){if(!t.nested)return;if(t.delta._t)return;const e=t.delta;for(const i in e){const n=new s(e[i]);t.push(n,i)}t.exit()};N.filterName="objects";const C=t=>{if(!t||!t.children)return;if(t.delta._t)return;const e=t.children.length,i={};for(let n=0;n<e;n++){const e=t.children[n];if(void 0===e)continue;const r=e.childName;i[r]!==e.result&&(i[r]=e.result)}t.setResult(i).exit()};C.filterName="collectChildren";let A=null;function E(t,e){var i;if(!A){let n;if(!(null===(i=null==t?void 0:t.textDiff)||void 0===i?void 0:i.diffMatchPatch)){if(!e)return null;const t=new Error("The diff-match-patch library was not provided. Pass the library in through the options or use the `jsondiffpatch/with-text-diffs` entry-point.");throw t.diff_match_patch_not_found=!0,t}n=new t.textDiff.diffMatchPatch,A={diff:(t,e)=>n.patch_toText(n.patch_make(t,e)),patch:(t,e)=>{const i=n.patch_apply(n.patch_fromText(e),t);for(const t of i[1])if(!t){const t=new Error("text patch failed");throw t.textPatchFailed=!0,t}return i[0]}}}return A}const _=function(t){var e,i;if("string"!==t.leftType)return;const n=t.left,r=t.right,s=(null===(i=null===(e=t.options)||void 0===e?void 0:e.textDiff)||void 0===i?void 0:i.minLength)||60;if(n.length<s||r.length<s)return void t.setResult([n,r]).exit();const o=E(t.options);if(!o)return void t.setResult([n,r]).exit();const l=o.diff;t.setResult([l(n,r),0,2]).exit()};_.filterName="texts";const $=function(t){if(t.nested)return;const e=t.delta;if(2!==e[2])return;const i=e,n=E(t.options,!0).patch;t.setResult(n(t.left,i[0])).exit()};$.filterName="texts";const I=t=>{var e,i,n;const r=/^@@ +-(\d+),(\d+) +\+(\d+),(\d+) +@@$/,s=t.split("\n");for(let t=0;t<s.length;t++){const o=s[t];if(void 0===o)continue;const l=o.slice(0,1);if("@"===l){const e=r.exec(o);if(null!==e){s[t]=`@@ -${e[3]},${e[4]} +${e[1]},${e[2]} @@`}}else if("+"===l){if(s[t]=`-${null===(e=s[t])||void 0===e?void 0:e.slice(1)}`,"+"===(null===(i=s[t-1])||void 0===i?void 0:i.slice(0,1))){const e=s[t];s[t]=s[t-1],s[t-1]=e}}else"-"===l&&(s[t]=`+${null===(n=s[t])||void 0===n?void 0:n.slice(1)}`)}return s.join("\n")},j=function(t){if(t.nested)return;const e=t.delta;if(2!==e[2])return;const i=e;t.setResult([I(i[0]),0,2]).exit()};j.filterName="texts";const O=function(t){if(t.left!==t.right)if(void 0!==t.left)if(void 0!==t.right){if("function"==typeof t.left||"function"==typeof t.right)throw new Error("functions are not supported");t.leftType=null===t.left?"null":typeof t.left,t.rightType=null===t.right?"null":typeof t.right,t.leftType===t.rightType&&"boolean"!==t.leftType&&"number"!==t.leftType?("object"===t.leftType&&(t.leftIsArray=Array.isArray(t.left)),"object"===t.rightType&&(t.rightIsArray=Array.isArray(t.right)),t.leftIsArray===t.rightIsArray?t.left instanceof RegExp&&(t.right instanceof RegExp?t.setResult([t.left.toString(),t.right.toString()]).exit():t.setResult([t.left,t.right]).exit()):t.setResult([t.left,t.right]).exit()):t.setResult([t.left,t.right]).exit()}else t.setResult([t.left,0,0]).exit();else{if("function"==typeof t.right)throw new Error("functions are not supported");t.setResult([t.right]).exit()}else t.setResult(void 0).exit()};O.filterName="trivial";const D=function(t){if(void 0===t.delta)return void t.setResult(t.left).exit();if(t.nested=!Array.isArray(t.delta),t.nested)return;const e=t.delta;if(1!==e.length)if(2!==e.length)3===e.length&&0===e[2]&&t.setResult(void 0).exit();else{if(t.left instanceof RegExp){const i=/^\/(.*)\/([gimyu]+)$/.exec(e[1]);if(null==i?void 0:i[1])return void t.setResult(new RegExp(i[1],i[2])).exit()}t.setResult(e[1]).exit()}else t.setResult(e[0]).exit()};D.filterName="trivial";const T=function(t){if(void 0===t.delta)return void t.setResult(t.delta).exit();if(t.nested=!Array.isArray(t.delta),t.nested)return;const e=t.delta;1!==e.length?2!==e.length?3===e.length&&0===e[2]&&t.setResult([e[0]]).exit():t.setResult([e[1],e[0]]).exit():t.setResult([e[0],0,0]).exit()};T.filterName="trivial";class P{constructor(t){this.processor=new l(t),this.processor.pipe(new o("diff").append(y,O,m,_,w,h).shouldHaveResult()),this.processor.pipe(new o("patch").append(b,p,D,$,R,d).shouldHaveResult()),this.processor.pipe(new o("reverse").append(C,g,T,j,N,v).shouldHaveResult())}options(t){return this.processor.options(t)}diff(t,e){return this.processor.process(new n(t,e))}patch(t,e){return this.processor.process(new r(t,e))}reverse(t){return this.processor.process(new s(t))}unpatch(t,e){return this.patch(t,this.reverse(e))}clone(t){return e(t)}}function S(t){return new P(t)}let k;function H(t,e){return k||(k=new P),k.diff(t,e)}function L(t,e){return k||(k=new P),k.patch(t,e)}function B(t,e){return k||(k=new P),k.unpatch(t,e)}function q(t){return k||(k=new P),k.reverse(t)}function M(t){return k||(k=new P),k.clone(t)}export{P as DiffPatcher,M as clone,S as create,t as dateReviver,H as diff,L as patch,q as reverse,B as unpatch};export default null;
//# sourceMappingURL=/sm/e1ad0ead30e89bcd0534b8231d5f75486c018830e45b1a4769a9a80e8ae4a31d.map