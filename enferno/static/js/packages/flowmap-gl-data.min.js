if("undefined"==typeof globalThis)var global=globalThis;var process;!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(global=void 0!==t?t:t||self).FlowmapData=e()}(this,function(){"use strict";function t(t){const{children:e}=t;return e&&e.length>0}function e(t){const{zoom:e}=t;return void 0!==e}function n(t){return t&&!!t.aggregate}var r;function o(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function a(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function i(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function c(){}!function(t){t.ALL="ALL",t.INCOMING="INCOMING",t.OUTGOING="OUTGOING",t.BETWEEN="BETWEEN"}(r||(r={}));var s=.7,f=1/s,u="\\s*([+-]?\\d+)\\s*",l="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",d="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",h=/^#([0-9a-f]{3,8})$/,g=new RegExp(`^rgb\\(${u},${u},${u}\\)$`),b=new RegExp(`^rgb\\(${d},${d},${d}\\)$`),p=new RegExp(`^rgba\\(${u},${u},${u},${l}\\)$`),m=new RegExp(`^rgba\\(${d},${d},${d},${l}\\)$`),w=new RegExp(`^hsl\\(${l},${d},${d}\\)$`),y=new RegExp(`^hsla\\(${l},${d},${d},${l}\\)$`),M={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function v(){return this.rgb().formatHex()}function x(){return this.rgb().formatRgb()}function F(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=h.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?L(e):3===n?new T(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?C(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?C(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=g.exec(t))?new T(e[1],e[2],e[3],1):(e=b.exec(t))?new T(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=p.exec(t))?C(e[1],e[2],e[3],e[4]):(e=m.exec(t))?C(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=w.exec(t))?U(e[1],e[2]/100,e[3]/100,1):(e=y.exec(t))?U(e[1],e[2]/100,e[3]/100,e[4]):M.hasOwnProperty(t)?L(M[t]):"transparent"===t?new T(NaN,NaN,NaN,0):null}function L(t){return new T(t>>16&255,t>>8&255,255&t,1)}function C(t,e,n,r){return r<=0&&(t=e=n=NaN),new T(t,e,n,r)}function S(t){return t instanceof c||(t=F(t)),t?new T((t=t.rgb()).r,t.g,t.b,t.opacity):new T}function A(t,e,n,r){return 1===arguments.length?S(t):new T(t,e,n,null==r?1:r)}function T(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function I(){return`#${k(this.r)}${k(this.g)}${k(this.b)}`}function D(){const t=N(this.opacity);return`${1===t?"rgb(":"rgba("}${E(this.r)}, ${E(this.g)}, ${E(this.b)}${1===t?")":`, ${t})`}`}function N(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function E(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function k(t){return((t=E(t))<16?"0":"")+t.toString(16)}function U(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new z(t,e,n,r)}function O(t){if(t instanceof z)return new z(t.h,t.s,t.l,t.opacity);if(t instanceof c||(t=F(t)),!t)return new z;if(t instanceof z)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,o=Math.min(e,n,r),a=Math.max(e,n,r),i=NaN,s=a-o,f=(a+o)/2;return s?(i=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=f<.5?a+o:2-a-o,i*=60):s=f>0&&f<1?0:i,new z(i,s,f,t.opacity)}function z(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function P(t){return(t=(t||0)%360)<0?t+360:t}function B(t){return Math.max(0,Math.min(1,t||0))}function $(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}a(c,F,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:v,formatHex:v,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return O(this).formatHsl()},formatRgb:x,toString:x}),a(T,A,i(c,{brighter(t){return t=null==t?f:Math.pow(f,t),new T(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?s:Math.pow(s,t),new T(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new T(E(this.r),E(this.g),E(this.b),N(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:I,formatHex:I,formatHex8:function(){return`#${k(this.r)}${k(this.g)}${k(this.b)}${k(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:D,toString:D})),a(z,function(t,e,n,r){return 1===arguments.length?O(t):new z(t,e,n,null==r?1:r)},i(c,{brighter(t){return t=null==t?f:Math.pow(f,t),new z(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?s:Math.pow(s,t),new z(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,o=2*n-r;return new T($(t>=240?t-240:t+120,o,r),$(t,o,r),$(t<120?t+240:t-120,o,r),this.opacity)},clamp(){return new z(P(this.h),B(this.s),B(this.l),N(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=N(this.opacity);return`${1===t?"hsl(":"hsla("}${P(this.h)}, ${100*B(this.s)}%, ${100*B(this.l)}%${1===t?")":`, ${t})`}`}}));const _=Math.PI/180,Y=180/Math.PI,j=.96422,H=.82521,G=4/29,R=6/29,Z=3*R*R,q=R*R*R;function V(t){if(t instanceof K)return new K(t.l,t.a,t.b,t.opacity);if(t instanceof et)return nt(t);t instanceof T||(t=S(t));var e,n,r=Q(t.r),o=Q(t.g),a=Q(t.b),i=W((.2225045*r+.7168786*o+.0606169*a)/1);return r===o&&o===a?e=n=i:(e=W((.4360747*r+.3850649*o+.1430804*a)/j),n=W((.0139322*r+.0971045*o+.7141733*a)/H)),new K(116*i-16,500*(e-i),200*(i-n),t.opacity)}function K(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function W(t){return t>q?Math.pow(t,1/3):t/Z+G}function X(t){return t>R?t*t*t:Z*(t-G)}function J(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Q(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function tt(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof et)return new et(t.h,t.c,t.l,t.opacity);if(t instanceof K||(t=V(t)),0===t.a&&0===t.b)return new et(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Y;return new et(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}(t):new et(t,e,n,null==r?1:r)}function et(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function nt(t){if(isNaN(t.h))return new K(t.l,0,0,t.opacity);var e=t.h*_;return new K(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}a(K,function(t,e,n,r){return 1===arguments.length?V(t):new K(t,e,n,null==r?1:r)},i(c,{brighter(t){return new K(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker(t){return new K(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new T(J(3.1338561*(e=j*X(e))-1.6168667*(t=1*X(t))-.4906146*(n=H*X(n))),J(-.9787684*e+1.9161415*t+.033454*n),J(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),a(et,tt,i(c,{brighter(t){return new et(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker(t){return new et(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb(){return nt(this).rgb()}}));var rt=-.14861,ot=1.78277,at=-.29227,it=-.90649,ct=1.97294,st=ct*it,ft=ct*ot,ut=ot*at-it*rt;function lt(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof dt)return new dt(t.h,t.s,t.l,t.opacity);t instanceof T||(t=S(t));var e=t.r/255,n=t.g/255,r=t.b/255,o=(ut*r+st*e-ft*n)/(ut+st-ft),a=r-o,i=(ct*(n-o)-at*a)/it,c=Math.sqrt(i*i+a*a)/(ct*o*(1-o)),s=c?Math.atan2(i,a)*Y-120:NaN;return new dt(s<0?s+360:s,c,o,t.opacity)}(t):new dt(t,e,n,null==r?1:r)}function dt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function ht(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),o=t[r],a=t[r+1],i=r>0?t[r-1]:2*o-a,c=r<e-1?t[r+2]:2*a-o;return function(t,e,n,r,o){var a=t*t,i=a*t;return((1-3*t+3*a-i)*e+(4-6*a+3*i)*n+(1+3*t+3*a-3*i)*r+i*o)/6}((n-r/e)*e,i,o,a,c)}}a(dt,lt,i(c,{brighter(t){return t=null==t?f:Math.pow(f,t),new dt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?s:Math.pow(s,t),new dt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*_,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),o=Math.sin(t);return new T(255*(e+n*(rt*r+ot*o)),255*(e+n*(at*r+it*o)),255*(e+n*(ct*r)),this.opacity)}}));var gt=t=>()=>t;function bt(t,e){return function(n){return t+n*e}}function pt(t){return 1===(t=+t)?mt:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):gt(isNaN(e)?n:e)}}function mt(t,e){var n=e-t;return n?bt(t,n):gt(isNaN(t)?e:t)}var wt=function t(e){var n=pt(e);function r(t,e){var r=n((t=A(t)).r,(e=A(e)).r),o=n(t.g,e.g),a=n(t.b,e.b),i=mt(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=o(e),t.b=a(e),t.opacity=i(e),t+""}}return r.gamma=t,r}(1);var yt,Mt=(yt=ht,function(t){var e,n,r=t.length,o=new Array(r),a=new Array(r),i=new Array(r);for(e=0;e<r;++e)n=A(t[e]),o[e]=n.r||0,a[e]=n.g||0,i[e]=n.b||0;return o=yt(o),a=yt(a),i=yt(i),n.opacity=1,function(t){return n.r=o(t),n.g=a(t),n.b=i(t),n+""}});function vt(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,o=e.slice();return function(a){for(n=0;n<r;++n)o[n]=t[n]*(1-a)+e[n]*a;return o}}function xt(t,e){var n,r=e?e.length:0,o=t?Math.min(r,t.length):0,a=new Array(o),i=new Array(r);for(n=0;n<o;++n)a[n]=It(t[n],e[n]);for(;n<r;++n)i[n]=e[n];return function(t){for(n=0;n<o;++n)i[n]=a[n](t);return i}}function Ft(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Lt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Ct(t,e){var n,r={},o={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=It(t[n],e[n]):o[n]=e[n];return function(t){for(n in r)o[n]=r[n](t);return o}}var St=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,At=new RegExp(St.source,"g");function Tt(t,e){var n,r,o,a=St.lastIndex=At.lastIndex=0,i=-1,c=[],s=[];for(t+="",e+="";(n=St.exec(t))&&(r=At.exec(e));)(o=r.index)>a&&(o=e.slice(a,o),c[i]?c[i]+=o:c[++i]=o),(n=n[0])===(r=r[0])?c[i]?c[i]+=r:c[++i]=r:(c[++i]=null,s.push({i:i,x:Lt(n,r)})),a=At.lastIndex;return a<e.length&&(o=e.slice(a),c[i]?c[i]+=o:c[++i]=o),c.length<2?s[0]?function(t){return function(e){return t(e)+""}}(s[0].x):function(t){return function(){return t}}(e):(e=s.length,function(t){for(var n,r=0;r<e;++r)c[(n=s[r]).i]=n.x(t);return c.join("")})}function It(t,e){var n,r,o=typeof e;return null==e||"boolean"===o?gt(e):("number"===o?Lt:"string"===o?(n=F(e))?(e=n,wt):Tt:e instanceof F?wt:e instanceof Date?Ft:(r=e,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(e)?xt:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Ct:Lt:vt))(t,e)}function Dt(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Nt(t){return function e(n){function r(e,r){var o=t((e=lt(e)).h,(r=lt(r)).h),a=mt(e.s,r.s),i=mt(e.l,r.l),c=mt(e.opacity,r.opacity);return function(t){return e.h=o(t),e.s=a(t),e.l=i(Math.pow(t,n)),e.opacity=c(t),e+""}}return n=+n,r.gamma=e,r}(1)}Nt(function(t,e){var n=e-t;return n?bt(t,n>180||n<-180?n-360*Math.round(n/360):n):gt(isNaN(t)?e:t)});var Et=Nt(mt),kt=t=>Mt(t[t.length-1]),Ut=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(o);kt(Ut);var Ot=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(o);kt(Ot);var zt=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(o);kt(zt);var Pt=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(o);kt(Pt);var Bt=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(o);kt(Bt);var $t=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(o);kt($t);var _t=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(o);kt(_t);var Yt=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(o);kt(Yt);var jt=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(o);kt(jt);var Ht=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(o);kt(Ht);var Gt=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(o);kt(Gt);var Rt=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(o);kt(Rt);var Zt=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(o);kt(Zt);var qt=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(o);kt(qt);var Vt=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(o);kt(Vt);var Kt=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(o);kt(Kt);var Wt=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(o);kt(Wt);var Xt=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(o);kt(Xt);var Jt=Et(lt(-100,.75,.35),lt(80,1.5,.8)),Qt=Et(lt(260,.75,.35),lt(80,1.5,.8));function te(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}lt();var ee=te(o("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),ne=te(o("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),re=te(o("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),oe=te(o("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function ae(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ie(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ce(t){let e,n,r;function o(t,r,o=0,a=t.length){if(o<a){if(0!==e(r,r))return a;do{const e=o+a>>>1;n(t[e],r)<0?o=e+1:a=e}while(o<a)}return o}return 2!==t.length?(e=ae,n=(e,n)=>ae(t(e),n),r=(e,n)=>t(e)-n):(e=t===ae||t===ie?t:se,n=t,r=t),{left:o,center:function(t,e,n=0,a=t.length){const i=o(t,e,n,a-1);return i>n&&r(t[i-1],e)>-r(t[i],e)?i-1:i},right:function(t,r,o=0,a=t.length){if(o<a){if(0!==e(r,r))return a;do{const e=o+a>>>1;n(t[e],r)<=0?o=e+1:a=e}while(o<a)}return o}}}function se(){return 0}const fe=ce(ae),ue=fe.right,le=fe.left;function de(t,e){let n,r;if(void 0===e)for(const e of t)null!=e&&(void 0===n?e>=e&&(n=r=e):(n>e&&(n=e),r<e&&(r=e)));else{let o=-1;for(let a of t)null!=(a=e(a,++o,t))&&(void 0===n?a>=a&&(n=r=a):(n>a&&(n=a),r<a&&(r=a)))}return[n,r]}ce(function(t){return null===t?NaN:+t}).center;class he{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const o=e[r],a=t+o,i=Math.abs(t)<Math.abs(o)?t-(a-o):o-(a-t);i&&(e[n++]=i),t=a}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,o=this._n,a=0;if(o>0){for(a=t[--o];o>0&&(e=a,n=t[--o],a=e+n,r=n-(a-e),!r););o>0&&(r<0&&t[o-1]<0||r>0&&t[o-1]>0)&&(n=2*r,e=a+n,n==e-a&&(a=e))}return a}}class ge extends Map{constructor(t,e=pe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(be(this,t))}has(t){return super.has(be(this,t))}set(t,e){return super.set(function({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}(this,t),e)}delete(t){return super.delete(function({_intern:t,_key:e},n){const r=e(n);t.has(r)&&(n=t.get(r),t.delete(r));return n}(this,t))}}function be({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function pe(t){return null!==t&&"object"==typeof t?t.valueOf():t}function me(t){return t}function we(t,e,...n){return function(t,e,n,r){return function t(o,a){if(a>=r.length)return n(o);const i=new ge,c=r[a++];let s=-1;for(const t of o){const e=c(t,++s,o),n=i.get(e);n?n.push(t):i.set(e,[t])}for(const[e,n]of i)i.set(e,t(n,a));return e(i)}(t,0)}(t,me,e,n)}const ye=Math.sqrt(50),Me=Math.sqrt(10),ve=Math.sqrt(2);function xe(t,e,n){const r=(e-t)/Math.max(0,n),o=Math.floor(Math.log10(r)),a=r/Math.pow(10,o),i=a>=ye?10:a>=Me?5:a>=ve?2:1;let c,s,f;return o<0?(f=Math.pow(10,-o)/i,c=Math.round(t*f),s=Math.round(e*f),c/f<t&&++c,s/f>e&&--s,f=-f):(f=Math.pow(10,o)*i,c=Math.round(t/f),s=Math.round(e/f),c*f<t&&++c,s*f>e&&--s),s<c&&.5<=n&&n<2?xe(t,e,2*n):[c,s,f]}function Fe(t,e,n){return xe(t=+t,e=+e,n=+n)[2]}function Le(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let o of t)null!=(o=e(o,++r,t))&&(n>o||void 0===n&&o>=o)&&(n=o)}return n}function Ce(t,e,n){t=+t,e=+e,n=(o=arguments.length)<2?(e=t,t=0,1):o<3?1:+n;for(var r=-1,o=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(o);++r<o;)a[r]=t+r*n;return a}function Se(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Ae(t,e){switch(arguments.length){case 0:break;case 1:"function"==typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"==typeof e?this.interpolator(e):this.range(e)}return this}function Te(t){return+t}var Ie=[0,1];function De(t){return t}function Ne(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function Ee(t,e,n){var r=t[0],o=t[1],a=e[0],i=e[1];return o<r?(r=Ne(o,r),a=n(i,a)):(r=Ne(r,o),a=n(a,i)),function(t){return a(r(t))}}function ke(t,e,n){var r=Math.min(t.length,e.length)-1,o=new Array(r),a=new Array(r),i=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++i<r;)o[i]=Ne(t[i],t[i+1]),a[i]=n(e[i],e[i+1]);return function(e){var n=ue(t,e,1,r)-1;return a[n](o[n](e))}}function Ue(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Oe(){var t,e,n,r,o,a,i=Ie,c=Ie,s=It,f=De;function u(){var t,e,n,s=Math.min(i.length,c.length);return f!==De&&(t=i[0],e=i[s-1],t>e&&(n=t,t=e,e=n),f=function(n){return Math.max(t,Math.min(e,n))}),r=s>2?ke:Ee,o=a=null,l}function l(e){return null==e||isNaN(e=+e)?n:(o||(o=r(i.map(t),c,s)))(t(f(e)))}return l.invert=function(n){return f(e((a||(a=r(c,i.map(t),Lt)))(n)))},l.domain=function(t){return arguments.length?(i=Array.from(t,Te),u()):i.slice()},l.range=function(t){return arguments.length?(c=Array.from(t),u()):c.slice()},l.rangeRound=function(t){return c=Array.from(t),s=Dt,u()},l.clamp=function(t){return arguments.length?(f=!!t||De,u()):f!==De},l.interpolate=function(t){return arguments.length?(s=t,u()):s},l.unknown=function(t){return arguments.length?(n=t,l):n},function(n,r){return t=n,e=r,u()}}function ze(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Pe(t){return(t=ze(Math.abs(t)))?t[1]:NaN}var Be,$e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function _e(t){if(!(e=$e.exec(t)))throw new Error("invalid format: "+t);var e;return new Ye({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Ye(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function je(t,e){var n=ze(t,e);if(!n)return t+"";var r=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+r:r.length>o+1?r.slice(0,o+1)+"."+r.slice(o+1):r+new Array(o-r.length+2).join("0")}_e.prototype=Ye.prototype,Ye.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var He={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>je(100*t,e),r:je,s:function(t,e){var n=ze(t,e);if(!n)return t+"";var r=n[0],o=n[1],a=o-(Be=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,i=r.length;return a===i?r:a>i?r+new Array(a-i+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+ze(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Ge(t){return t}var Re,Ze,qe,Ve=Array.prototype.map,Ke=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function We(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?Ge:(e=Ve.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var o=t.length,a=[],i=0,c=e[0],s=0;o>0&&c>0&&(s+c+1>r&&(c=Math.max(1,r-s)),a.push(t.substring(o-=c,o+c)),!((s+=c+1)>r));)c=e[i=(i+1)%e.length];return a.reverse().join(n)}),o=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",i=void 0===t.decimal?".":t.decimal+"",c=void 0===t.numerals?Ge:function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(Ve.call(t.numerals,String)),s=void 0===t.percent?"%":t.percent+"",f=void 0===t.minus?"−":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function l(t){var e=(t=_e(t)).fill,n=t.align,l=t.sign,d=t.symbol,h=t.zero,g=t.width,b=t.comma,p=t.precision,m=t.trim,w=t.type;"n"===w?(b=!0,w="g"):He[w]||(void 0===p&&(p=12),m=!0,w="g"),(h||"0"===e&&"="===n)&&(h=!0,e="0",n="=");var y="$"===d?o:"#"===d&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",M="$"===d?a:/[%p]/.test(w)?s:"",v=He[w],x=/[defgprs%]/.test(w);function F(t){var o,a,s,d=y,F=M;if("c"===w)F=v(t)+F,t="";else{var L=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:v(Math.abs(t),p),m&&(t=function(t){t:for(var e,n=t.length,r=1,o=-1;r<n;++r)switch(t[r]){case".":o=e=r;break;case"0":0===o&&(o=r),e=r;break;default:if(!+t[r])break t;o>0&&(o=0)}return o>0?t.slice(0,o)+t.slice(e+1):t}(t)),L&&0===+t&&"+"!==l&&(L=!1),d=(L?"("===l?l:f:"-"===l||"("===l?"":l)+d,F=("s"===w?Ke[8+Be/3]:"")+F+(L&&"("===l?")":""),x)for(o=-1,a=t.length;++o<a;)if(48>(s=t.charCodeAt(o))||s>57){F=(46===s?i+t.slice(o+1):t.slice(o))+F,t=t.slice(0,o);break}}b&&!h&&(t=r(t,1/0));var C=d.length+t.length+F.length,S=C<g?new Array(g-C+1).join(e):"";switch(b&&h&&(t=r(S+t,S.length?g-F.length:1/0),S=""),n){case"<":t=d+t+F+S;break;case"=":t=d+S+t+F;break;case"^":t=S.slice(0,C=S.length>>1)+d+t+F+S.slice(C);break;default:t=S+d+t+F}return c(t)}return p=void 0===p?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,p)):Math.max(0,Math.min(20,p)),F.toString=function(){return t+""},F}return{format:l,formatPrefix:function(t,e){var n=l(((t=_e(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Pe(e)/3))),o=Math.pow(10,-r),a=Ke[8+r/3];return function(t){return n(o*t)+a}}}}function Xe(t,e,n,r){var o,a=function(t,e,n){n=+n;const r=(e=+e)<(t=+t),o=r?Fe(e,t,n):Fe(t,e,n);return(r?-1:1)*(o<0?1/-o:o)}(t,e,n);switch((r=_e(null==r?",f":r)).type){case"s":var i=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(o=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Pe(e)/3)))-Pe(Math.abs(t)))}(a,i))||(r.precision=o),qe(r,i);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(o=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Pe(e)-Pe(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=o-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(o=function(t){return Math.max(0,-Pe(Math.abs(t)))}(a))||(r.precision=o-2*("%"===r.type))}return Ze(r)}function Je(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){if(!((n=+n)>0))return[];if((t=+t)===(e=+e))return[t];const r=e<t,[o,a,i]=r?xe(e,t,n):xe(t,e,n);if(!(a>=o))return[];const c=a-o+1,s=new Array(c);if(r)if(i<0)for(let t=0;t<c;++t)s[t]=(a-t)/-i;else for(let t=0;t<c;++t)s[t]=(a-t)*i;else if(i<0)for(let t=0;t<c;++t)s[t]=(o+t)/-i;else for(let t=0;t<c;++t)s[t]=(o+t)*i;return s}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return Xe(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,o,a=e(),i=0,c=a.length-1,s=a[i],f=a[c],u=10;for(f<s&&(o=s,s=f,f=o,o=i,i=c,c=o);u-- >0;){if((o=Fe(s,f,n))===r)return a[i]=s,a[c]=f,e(a);if(o>0)s=Math.floor(s/o)*o,f=Math.ceil(f/o)*o;else{if(!(o<0))break;s=Math.ceil(s*o)/o,f=Math.floor(f*o)/o}r=o}return t},t}function Qe(){var t=Oe()(De,De);return t.copy=function(){return Ue(t,Qe())},Se.apply(t,arguments),Je(t)}function tn(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function en(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function nn(t){return t<0?-t*t:t*t}function rn(t){var e=t(De,De),n=1;return e.exponent=function(e){return arguments.length?1===(n=+e)?t(De,De):.5===n?t(en,nn):t(tn(n),tn(1/n)):n},Je(e)}function on(){var t=rn(Oe());return t.copy=function(){return Ue(t,on()).exponent(t.exponent())},Se.apply(t,arguments),t}Re=We({thousands:",",grouping:[3],currency:["$",""]}),Ze=Re.format,qe=Re.formatPrefix;const an=new Date,cn=new Date;function sn(t,e,n,r){function o(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return o.floor=e=>(t(e=new Date(+e)),e),o.ceil=n=>(t(n=new Date(n-1)),e(n,1),t(n),n),o.round=t=>{const e=o(t),n=o.ceil(t);return t-e<n-t?e:n},o.offset=(t,n)=>(e(t=new Date(+t),null==n?1:Math.floor(n)),t),o.range=(n,r,a)=>{const i=[];if(n=o.ceil(n),a=null==a?1:Math.floor(a),!(n<r&&a>0))return i;let c;do{i.push(c=new Date(+n)),e(n,a),t(n)}while(c<n&&n<r);return i},o.filter=n=>sn(e=>{if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)},(t,r)=>{if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}),n&&(o.count=(e,r)=>(an.setTime(+e),cn.setTime(+r),t(an),t(cn),Math.floor(n(an,cn))),o.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?o.filter(r?e=>r(e)%t===0:e=>o.count(0,e)%t===0):o:null)),o}const fn=1e3,un=6e4,ln=36e5,dn=864e5,hn=6048e5,gn=sn(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*fn)},(t,e)=>(e-t)/fn,t=>t.getUTCSeconds());gn.range;const bn=sn(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*fn)},(t,e)=>{t.setTime(+t+e*un)},(t,e)=>(e-t)/un,t=>t.getMinutes());bn.range;const pn=sn(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*un)},(t,e)=>(e-t)/un,t=>t.getUTCMinutes());pn.range;const mn=sn(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*fn-t.getMinutes()*un)},(t,e)=>{t.setTime(+t+e*ln)},(t,e)=>(e-t)/ln,t=>t.getHours());mn.range;const wn=sn(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*ln)},(t,e)=>(e-t)/ln,t=>t.getUTCHours());wn.range;const yn=sn(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*un)/dn,t=>t.getDate()-1);yn.range;const Mn=sn(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/dn,t=>t.getUTCDate()-1);Mn.range;const vn=sn(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/dn,t=>Math.floor(t/dn));function xn(t){return sn(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(t,e)=>{t.setDate(t.getDate()+7*e)},(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*un)/hn)}vn.range;const Fn=xn(0),Ln=xn(1),Cn=xn(2),Sn=xn(3),An=xn(4),Tn=xn(5),In=xn(6);function Dn(t){return sn(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+7*e)},(t,e)=>(e-t)/hn)}Fn.range,Ln.range,Cn.range,Sn.range,An.range,Tn.range,In.range;const Nn=Dn(0),En=Dn(1),kn=Dn(2),Un=Dn(3),On=Dn(4),zn=Dn(5),Pn=Dn(6);Nn.range,En.range,kn.range,Un.range,On.range,zn.range,Pn.range;const Bn=sn(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear()),t=>t.getMonth());Bn.range;const $n=sn(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear()),t=>t.getUTCMonth());$n.range;const _n=sn(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());_n.every=t=>isFinite(t=Math.floor(t))&&t>0?sn(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)}):null,_n.range;const Yn=sn(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());function jn(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Hn(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Gn(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}Yn.every=t=>isFinite(t=Math.floor(t))&&t>0?sn(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null,Yn.range;var Rn,Zn,qn,Vn={"-":"",_:" ",0:"0"},Kn=/^\s*\d+/,Wn=/^%/,Xn=/[\\^$*+?|[\]().{}]/g;function Jn(t,e,n){var r=t<0?"-":"",o=(r?-t:t)+"",a=o.length;return r+(a<n?new Array(n-a+1).join(e)+o:o)}function Qn(t){return t.replace(Xn,"\\$&")}function tr(t){return new RegExp("^(?:"+t.map(Qn).join("|")+")","i")}function er(t){return new Map(t.map((t,e)=>[t.toLowerCase(),e]))}function nr(t,e,n){var r=Kn.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function rr(t,e,n){var r=Kn.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function or(t,e,n){var r=Kn.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function ar(t,e,n){var r=Kn.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function ir(t,e,n){var r=Kn.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function cr(t,e,n){var r=Kn.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function sr(t,e,n){var r=Kn.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function fr(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function ur(t,e,n){var r=Kn.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function lr(t,e,n){var r=Kn.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function dr(t,e,n){var r=Kn.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function hr(t,e,n){var r=Kn.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function gr(t,e,n){var r=Kn.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function br(t,e,n){var r=Kn.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function pr(t,e,n){var r=Kn.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function mr(t,e,n){var r=Kn.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function wr(t,e,n){var r=Kn.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function yr(t,e,n){var r=Wn.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Mr(t,e,n){var r=Kn.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function vr(t,e,n){var r=Kn.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function xr(t,e){return Jn(t.getDate(),e,2)}function Fr(t,e){return Jn(t.getHours(),e,2)}function Lr(t,e){return Jn(t.getHours()%12||12,e,2)}function Cr(t,e){return Jn(1+yn.count(_n(t),t),e,3)}function Sr(t,e){return Jn(t.getMilliseconds(),e,3)}function Ar(t,e){return Sr(t,e)+"000"}function Tr(t,e){return Jn(t.getMonth()+1,e,2)}function Ir(t,e){return Jn(t.getMinutes(),e,2)}function Dr(t,e){return Jn(t.getSeconds(),e,2)}function Nr(t){var e=t.getDay();return 0===e?7:e}function Er(t,e){return Jn(Fn.count(_n(t)-1,t),e,2)}function kr(t){var e=t.getDay();return e>=4||0===e?An(t):An.ceil(t)}function Ur(t,e){return t=kr(t),Jn(An.count(_n(t),t)+(4===_n(t).getDay()),e,2)}function Or(t){return t.getDay()}function zr(t,e){return Jn(Ln.count(_n(t)-1,t),e,2)}function Pr(t,e){return Jn(t.getFullYear()%100,e,2)}function Br(t,e){return Jn((t=kr(t)).getFullYear()%100,e,2)}function $r(t,e){return Jn(t.getFullYear()%1e4,e,4)}function _r(t,e){var n=t.getDay();return Jn((t=n>=4||0===n?An(t):An.ceil(t)).getFullYear()%1e4,e,4)}function Yr(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Jn(e/60|0,"0",2)+Jn(e%60,"0",2)}function jr(t,e){return Jn(t.getUTCDate(),e,2)}function Hr(t,e){return Jn(t.getUTCHours(),e,2)}function Gr(t,e){return Jn(t.getUTCHours()%12||12,e,2)}function Rr(t,e){return Jn(1+Mn.count(Yn(t),t),e,3)}function Zr(t,e){return Jn(t.getUTCMilliseconds(),e,3)}function qr(t,e){return Zr(t,e)+"000"}function Vr(t,e){return Jn(t.getUTCMonth()+1,e,2)}function Kr(t,e){return Jn(t.getUTCMinutes(),e,2)}function Wr(t,e){return Jn(t.getUTCSeconds(),e,2)}function Xr(t){var e=t.getUTCDay();return 0===e?7:e}function Jr(t,e){return Jn(Nn.count(Yn(t)-1,t),e,2)}function Qr(t){var e=t.getUTCDay();return e>=4||0===e?On(t):On.ceil(t)}function to(t,e){return t=Qr(t),Jn(On.count(Yn(t),t)+(4===Yn(t).getUTCDay()),e,2)}function eo(t){return t.getUTCDay()}function no(t,e){return Jn(En.count(Yn(t)-1,t),e,2)}function ro(t,e){return Jn(t.getUTCFullYear()%100,e,2)}function oo(t,e){return Jn((t=Qr(t)).getUTCFullYear()%100,e,2)}function ao(t,e){return Jn(t.getUTCFullYear()%1e4,e,4)}function io(t,e){var n=t.getUTCDay();return Jn((t=n>=4||0===n?On(t):On.ceil(t)).getUTCFullYear()%1e4,e,4)}function co(){return"+0000"}function so(){return"%"}function fo(t){return+t}function uo(t){return Math.floor(+t/1e3)}function lo(){var t,e,n,r,o,a=0,i=1,c=De,s=!1;function f(e){return null==e||isNaN(e=+e)?o:c(0===n?.5:(e=(r(e)-t)*n,s?Math.max(0,Math.min(1,e)):e))}function u(t){return function(e){var n,r;return arguments.length?([n,r]=e,c=t(n,r),f):[c(0),c(1)]}}return f.domain=function(o){return arguments.length?([a,i]=o,t=r(a=+a),e=r(i=+i),n=t===e?0:1/(e-t),f):[a,i]},f.clamp=function(t){return arguments.length?(s=!!t,f):s},f.interpolator=function(t){return arguments.length?(c=t,f):c},f.range=u(It),f.rangeRound=u(Dt),f.unknown=function(t){return arguments.length?(o=t,f):o},function(o){return r=o,t=o(a),e=o(i),n=t===e?0:1/(e-t),f}}function ho(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function go(){var t=Je(lo()(De));return t.copy=function(){return ho(t,go())},Ae.apply(t,arguments)}function bo(){var t=rn(lo());return t.copy=function(){return ho(t,bo()).exponent(t.exponent())},Ae.apply(t,arguments)}!function(t){Rn=function(t){var e=t.dateTime,n=t.date,r=t.time,o=t.periods,a=t.days,i=t.shortDays,c=t.months,s=t.shortMonths,f=tr(o),u=er(o),l=tr(a),d=er(a),h=tr(i),g=er(i),b=tr(c),p=er(c),m=tr(s),w=er(s),y={a:function(t){return i[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return s[t.getMonth()]},B:function(t){return c[t.getMonth()]},c:null,d:xr,e:xr,f:Ar,g:Br,G:_r,H:Fr,I:Lr,j:Cr,L:Sr,m:Tr,M:Ir,p:function(t){return o[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:fo,s:uo,S:Dr,u:Nr,U:Er,V:Ur,w:Or,W:zr,x:null,X:null,y:Pr,Y:$r,Z:Yr,"%":so},M={a:function(t){return i[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return s[t.getUTCMonth()]},B:function(t){return c[t.getUTCMonth()]},c:null,d:jr,e:jr,f:qr,g:oo,G:io,H:Hr,I:Gr,j:Rr,L:Zr,m:Vr,M:Kr,p:function(t){return o[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:fo,s:uo,S:Wr,u:Xr,U:Jr,V:to,w:eo,W:no,x:null,X:null,y:ro,Y:ao,Z:co,"%":so},v={a:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=g.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(t,e,n){var r=l.exec(e.slice(n));return r?(t.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=w.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(t,e,n){var r=b.exec(e.slice(n));return r?(t.m=p.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(t,n,r){return L(t,e,n,r)},d:dr,e:dr,f:wr,g:sr,G:cr,H:gr,I:gr,j:hr,L:mr,m:lr,M:br,p:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.p=u.get(r[0].toLowerCase()),n+r[0].length):-1},q:ur,Q:Mr,s:vr,S:pr,u:rr,U:or,V:ar,w:nr,W:ir,x:function(t,e,r){return L(t,n,e,r)},X:function(t,e,n){return L(t,r,e,n)},y:sr,Y:cr,Z:fr,"%":yr};function x(t,e){return function(n){var r,o,a,i=[],c=-1,s=0,f=t.length;for(n instanceof Date||(n=new Date(+n));++c<f;)37===t.charCodeAt(c)&&(i.push(t.slice(s,c)),null!=(o=Vn[r=t.charAt(++c)])?r=t.charAt(++c):o="e"===r?" ":"0",(a=e[r])&&(r=a(n,o)),i.push(r),s=c+1);return i.push(t.slice(s,c)),i.join("")}}function F(t,e){return function(n){var r,o,a=Gn(1900,void 0,1);if(L(a,t,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(e&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(o=(r=Hn(Gn(a.y,0,1))).getUTCDay(),r=o>4||0===o?En.ceil(r):En(r),r=Mn.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(o=(r=jn(Gn(a.y,0,1))).getDay(),r=o>4||0===o?Ln.ceil(r):Ln(r),r=yn.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),o="Z"in a?Hn(Gn(a.y,0,1)).getUTCDay():jn(Gn(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(o+5)%7:a.w+7*a.U-(o+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,Hn(a)):jn(a)}}function L(t,e,n,r){for(var o,a,i=0,c=e.length,s=n.length;i<c;){if(r>=s)return-1;if(37===(o=e.charCodeAt(i++))){if(o=e.charAt(i++),!(a=v[o in Vn?e.charAt(i++):o])||(r=a(t,n,r))<0)return-1}else if(o!=n.charCodeAt(r++))return-1}return r}return y.x=x(n,y),y.X=x(r,y),y.c=x(e,y),M.x=x(n,M),M.X=x(r,M),M.c=x(e,M),{format:function(t){var e=x(t+="",y);return e.toString=function(){return t},e},parse:function(t){var e=F(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=x(t+="",M);return e.toString=function(){return t},e},utcParse:function(t){var e=F(t+="",!0);return e.toString=function(){return t},e}}}(t),Zn=Rn.format,qn=Rn.parse,Rn.utcFormat,Rn.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});const po="rgba(240,240,240,0.5)",mo=[po,"#137CBD"],wo=[po,"#f6654e"],yo=[po,"#00a9cc"],Mo=[255,255,255,255];function vo(t){return Math.round(255*t)}function xo(t,e){const n=F(t);if(!n)return console.warn("Invalid color: ",t),`rgba(255, 255, 255, ${e})`;const r=n.rgb();return`rgba(${r.r}, ${r.g}, ${r.b}, ${e})`}function Fo(t){if(Array.isArray(t))return t;const e=F(t);if(!e)return console.warn("Invalid color: ",t),Mo;const n=e.rgb();return[Math.floor(n.r),Math.floor(n.g),Math.floor(n.b),vo(e.opacity)]}function Lo(t,e){return t?Fo(t):"string"==typeof e?Fo(e):e}const Co=t=>t[t.length-1];var So;!function(t){t.primary="#162d3c"}(So||(So={}));const Ao=t=>Ce(0,21).map(e=>t(e/20)).reverse(),To="rgba(240,240,240,0.5)",Io=[To,So.primary],Do=["#d1eeea","#a8dbd9","#85c4c9","#68abb8","#4f90a6","#3b738f","#2a5674"],No=Do,Eo={Blues:Co(Zt),BluGrn:["#c4e6c3","#96d2a4","#6dbc90","#4da284","#36877a","#266b6e","#1d4f60"],BluYl:["#f7feae","#b7e6a5","#7ccba2","#46aea0","#089099","#00718b","#045275"],BrwnYl:["#ede5cf","#e0c2a2","#d39c83","#c1766f","#a65461","#813753","#541f3f"],BuGn:Co(Ut),BuPu:Co(Ot),Burg:["#ffc6c4","#f4a3a8","#e38191","#cc607d","#ad466c","#8b3058","#672044"],BurgYl:["#fbe6c5","#f5ba98","#ee8a82","#dc7176","#c8586c","#9c3f5d","#70284a"],Cool:Ao(Qt),DarkMint:["#d2fbd4","#a5dbc2","#7bbcb0","#559c9e","#3a7c89","#235d72","#123f5a"],Emrld:["#d3f2a3","#97e196","#6cc08b","#4c9b82","#217a79","#105965","#074050"],GnBu:Co(zt),Grayish:Io,Greens:Co(qt),Greys:Co(Vt),Inferno:Ao(re),Magenta:["#f3cbd3","#eaa9bd","#dd88ac","#ca699d","#b14d8e","#91357d","#6c2167"],Magma:Ao(ne),Mint:["#e4f1e1","#b4d9cc","#89c0b6","#63a6a0","#448c8a","#287274","#0d585f"],Oranges:Co(Xt),OrRd:Co(Pt),OrYel:["#ecda9a","#efc47e","#f3ad6a","#f7945d","#f97b57","#f66356","#ee4d5a"],Peach:["#fde0c5","#facba6","#f8b58b","#f59e72","#f2855d","#ef6a4c","#eb4a40"],Plasma:Ao(oe),PinkYl:["#fef6b5","#ffdd9a","#ffc285","#ffa679","#fa8a76","#f16d7a","#e15383"],PuBu:Co($t),PuBuGn:Co(Bt),PuRd:Co(_t),Purp:["#f3e0f7","#e4c7f1","#d1afe8","#b998dd","#9f82ce","#826dba","#63589f"],Purples:Co(Kt),PurpOr:["#f9ddda","#f2b9c4","#e597b9","#ce78b3","#ad5fad","#834ba0","#573b88"],RdPu:Co(Yt),RedOr:["#f6d2a9","#f5b78e","#f19c7c","#ea8171","#dd686c","#ca5268","#b13f64"],Reds:Co(Wt),Sunset:["#f3e79b","#fac484","#f8a07e","#eb7f86","#ce6693","#a059a0","#5c53a5"],SunsetDark:["#fcde9c","#faa476","#f0746e","#e34f6f","#dc3977","#b9257a","#7c1d6f"],Teal:Do,TealGrn:["#b0f2bc","#89e8ac","#67dba5","#4cc8a3","#38b2a3","#2c98a0","#257d98"],Viridis:Ao(ee),Warm:Ao(Jt),YlGn:Co(Ht),YlGnBu:Co(jt),YlOrBr:Co(Gt),YlOrRd:Co(Rt)},ko=Object.keys(Eo),Uo={negative:{flows:{scheme:[To,"#17a5be"]}},positive:{flows:{scheme:[To,"#f52020"]}},locationAreas:{outline:"rgba(92,112,128,0.5)",normal:"rgba(220,220,220,0.5)"},outlineColor:"rgb(230,233,237)"};function Oo(t,e,n,r,o,a,i){if(t)return Uo;let c;Array.isArray(e)?c=e:(c=e&&Eo[e]||No,n&&(c=c.slice().reverse()));{const t=Ce(0,Math.max(10,c.length)),e=t.length-1,i=go(Mt(c)).domain([0,e]);if(r&&0!==a){const r=on().exponent(1.5).domain([e,0]).range([0,2*a/100]);c=t.map((t,e)=>{const a=i(e),c=r(e);if(null==a||null==c)return"#000";const s=tt(a);return s.l=n?s.l-s.l*c:s.l+(100-s.l)*c,s.c=s.c-s.c*(c/4),o&&(s.opacity=s.opacity*(1-c)),s.toString()})}else c=t.map((t,e)=>i(e))}return{darkMode:n,flows:{scheme:c},locationCircles:{outgoing:n?"#000":"#fff"},outlineColor:n?"#000":"rgba(255, 255, 255, 0.5)"}}function zo(t,e,n){const r=bo(function(t){const e=ht,n=t.length;let r,o,a=new Array(n),i=new Array(n),c=new Array(n),s=new Array(n);for(r=0;r<n;++r)o=A(t[r]),a[r]=o.r||0,i[r]=o.g||0,c[r]=o.b||0,s[r]=o.opacity||0;return a=e(a),i=e(i),c=e(c),s=e(s),function(t){return o.r=a(t),o.g=i(t),o.b=c(t),o.opacity=s(t),o+""}}(e)).exponent(n?.5:1/3).domain(t);return t=>Fo(r(t))}function Po(t,e,n){const r=e?e[0]:0,o=e?e[1]:0;if($o(t)){const e=zo([0,o],t.positive.flows.scheme,n),a=zo([0,r],t.negative.flows.scheme,n);return t=>t>=0?e(t):a(t)}const a=zo([0,o||0],t.flows.scheme,n);return t=>a(t)}function Bo(t){return void 0!==t.positive}function $o(t){return void 0!==t.positive}function _o(t,e){const n=t&&t.normal||"rgba(220,220,220,0.5)",r=tt(n),o=Fo(n);return{normal:o,connected:Lo(t&&t.connected,o),highlighted:Lo(t&&t.highlighted,xo(r[e?"brighter":"darker"](1).toString(),.5)),selected:Lo(t&&t.selected,xo(r[e?"brighter":"darker"](2).toString(),.8)),outline:Lo(t&&t.outline,Fo(r[e?"brighter":"darker"](4).toString()))}}function Yo(t,e,n){const r=t&&t.flows&&t.flows.scheme||e,o=tt(r[r.length-1]),a=Lo(t&&t.flows&&t.flows.highlighted,Fo(o[n?"brighter":"darker"](.7).toString())),i=Lo(t?.locationCircles?.empty,n?"#000":"#fff");return{flows:{scheme:r,highlighted:a},locationCircles:{inner:Lo(t&&t.locationCircles&&t.locationCircles.inner,o.toString()),outgoing:Lo(t&&t.locationCircles&&t.locationCircles.outgoing,n?"#000":"#fff"),incoming:Lo(t&&t.locationCircles&&t.locationCircles.incoming,o[n?"brighter":"darker"](1.25).toString()),highlighted:Lo(t&&t.locationCircles&&t.locationCircles.highlighted,a),empty:i,outlineEmptyMix:t?.locationCircles?.outlineEmptyMix??.4}}}function jo(t){const e=!(!t||!t.darkMode);return{darkMode:e,locationAreas:_o(t&&t.locationAreas,e),outlineColor:Fo(t&&t.outlineColor||"#fff"),dimmedOpacity:t&&null!=t.dimmedOpacity?t.dimmedOpacity:.4}}function Ho(t){const e=jo(t);return{...e,...Yo(t,mo,e.darkMode)}}function Go(t){const e=jo(t);return{...e,positive:Yo(t&&t.positive,wo,e.darkMode),negative:Yo(t&&t.negative,yo,e.darkMode)}}function Ro(t,e,n){return t+(e-t)*n}const Zo=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class qo{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[e,n]=new Uint8Array(t,0,2);if(219!==e)throw new Error("Data does not appear to be in a KDBush format.");const r=n>>4;if(1!==r)throw new Error(`Got v${r} data when expected v1.`);const o=Zo[15&n];if(!o)throw new Error("Unrecognized array type.");const[a]=new Uint16Array(t,2,1),[i]=new Uint32Array(t,4,1);return new qo(i,a,o,t)}constructor(t,e=64,n=Float64Array,r){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535),this.ArrayType=n,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const o=Zo.indexOf(this.ArrayType),a=2*t*this.ArrayType.BYTES_PER_ELEMENT,i=t*this.IndexArrayType.BYTES_PER_ELEMENT,c=(8-i%8)%8;if(o<0)throw new Error(`Unexpected typed array class: ${n}.`);r&&r instanceof ArrayBuffer?(this.data=r,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+i+c,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+a+i+c),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+i+c,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+o]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t)}add(t,e){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=t,this.coords[this._pos++]=e,n}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Vo(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,e,n,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:o,coords:a,nodeSize:i}=this,c=[0,o.length-1,0],s=[];for(;c.length;){const f=c.pop()||0,u=c.pop()||0,l=c.pop()||0;if(u-l<=i){for(let i=l;i<=u;i++){const c=a[2*i],f=a[2*i+1];c>=t&&c<=n&&f>=e&&f<=r&&s.push(o[i])}continue}const d=l+u>>1,h=a[2*d],g=a[2*d+1];h>=t&&h<=n&&g>=e&&g<=r&&s.push(o[d]),(0===f?t<=h:e<=g)&&(c.push(l),c.push(d-1),c.push(1-f)),(0===f?n>=h:r>=g)&&(c.push(d+1),c.push(u),c.push(1-f))}return s}within(t,e,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:o,nodeSize:a}=this,i=[0,r.length-1,0],c=[],s=n*n;for(;i.length;){const f=i.pop()||0,u=i.pop()||0,l=i.pop()||0;if(u-l<=a){for(let n=l;n<=u;n++)Jo(o[2*n],o[2*n+1],t,e)<=s&&c.push(r[n]);continue}const d=l+u>>1,h=o[2*d],g=o[2*d+1];Jo(h,g,t,e)<=s&&c.push(r[d]),(0===f?t-n<=h:e-n<=g)&&(i.push(l),i.push(d-1),i.push(1-f)),(0===f?t+n>=h:e+n>=g)&&(i.push(d+1),i.push(u),i.push(1-f))}return c}}function Vo(t,e,n,r,o,a){if(o-r<=n)return;const i=r+o>>1;Ko(t,e,i,r,o,a),Vo(t,e,n,r,i-1,1-a),Vo(t,e,n,i+1,o,1-a)}function Ko(t,e,n,r,o,a){for(;o>r;){if(o-r>600){const i=o-r+1,c=n-r+1,s=Math.log(i),f=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*f*(i-f)/i)*(c-i/2<0?-1:1);Ko(t,e,n,Math.max(r,Math.floor(n-c*f/i+u)),Math.min(o,Math.floor(n+(i-c)*f/i+u)),a)}const i=e[2*n+a];let c=r,s=o;for(Wo(t,e,r,n),e[2*o+a]>i&&Wo(t,e,r,o);c<s;){for(Wo(t,e,c,s),c++,s--;e[2*c+a]<i;)c++;for(;e[2*s+a]>i;)s--}e[2*r+a]===i?Wo(t,e,r,s):(s++,Wo(t,e,s,o)),s<=n&&(r=s+1),n<=s&&(o=s-1)}}function Wo(t,e,n,r){Xo(t,n,r),Xo(e,2*n,2*r),Xo(e,2*n+1,2*r+1)}function Xo(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Jo(t,e,n,r){const o=t-n,a=e-r;return o*o+a*a}var Qo="NOT_FOUND";var ta=function(t,e){return t===e};function ea(t,e){var n="object"==typeof e?e:{equalityCheck:e},r=n.equalityCheck,o=void 0===r?ta:r,a=n.maxSize,i=void 0===a?1:a,c=n.resultEqualityCheck,s=function(t){return function(e,n){if(null===e||null===n||e.length!==n.length)return!1;for(var r=e.length,o=0;o<r;o++)if(!t(e[o],n[o]))return!1;return!0}}(o),f=1===i?function(t){var e;return{get:function(n){return e&&t(e.key,n)?e.value:Qo},put:function(t,n){e={key:t,value:n}},getEntries:function(){return e?[e]:[]},clear:function(){e=void 0}}}(s):function(t,e){var n=[];function r(t){var r=n.findIndex(function(n){return e(t,n.key)});if(r>-1){var o=n[r];return r>0&&(n.splice(r,1),n.unshift(o)),o.value}return Qo}return{get:r,put:function(e,o){r(e)===Qo&&(n.unshift({key:e,value:o}),n.length>t&&n.pop())},getEntries:function(){return n},clear:function(){n=[]}}}(i,s);function u(){var e=f.get(arguments);if(e===Qo){if(e=t.apply(null,arguments),c){var n=f.getEntries().find(function(t){return c(t.value,e)});n&&(e=n.value)}f.put(arguments,e)}return e}return u.clearCache=function(){return f.clear()},u}function na(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];var a,i=0,c={memoizeOptions:void 0},s=r.pop();if("object"==typeof s&&(c=s,s=r.pop()),"function"!=typeof s)throw new Error("createSelector expects an output function after the inputs, but received: ["+typeof s+"]");var f=c.memoizeOptions,u=void 0===f?n:f,l=Array.isArray(u)?u:[u],d=function(t){var e=Array.isArray(t[0])?t[0]:t;if(!e.every(function(t){return"function"==typeof t})){var n=e.map(function(t){return"function"==typeof t?"function "+(t.name||"unnamed")+"()":typeof t}).join(", ");throw new Error("createSelector expects all input-selectors to be functions, but received the following types: ["+n+"]")}return e}(r),h=t.apply(void 0,[function(){return i++,s.apply(null,arguments)}].concat(l)),g=t(function(){for(var t=[],e=d.length,n=0;n<e;n++)t.push(d[n].apply(null,arguments));return a=h.apply(null,t)});return Object.assign(g,{resultFunc:s,memoizedResultFunc:h,dependencies:d,lastResult:function(){return a},recomputations:function(){return i},resetRecomputations:function(){return i=0}}),g}}var ra=na(ea),oa="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};function aa(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var n=function t(){return this instanceof t?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(e){var r=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,r.get?r:{enumerable:!0,get:function(){return t[e]}})}),n}var ia={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n=function(){var t=4022871197,e=function(e){e=String(e);for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)};return e}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function r(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function o(t,e){var o=new n(t),a=e&&e.state,i=o.next;return i.int32=function(){return 4294967296*o.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,a&&("object"==typeof a&&r(a,o),i.state=function(){return r(o,{})}),i}e&&e.exports?e.exports=o:this.alea=o}(0,t)}(ia);var ca=ia.exports,sa={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function o(t,e){var o=new n(t),a=e&&e.state,i=function(){return(o.next()>>>0)/4294967296};return i.double=function(){do{var t=((o.next()>>>11)+(o.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=o.next,i.quick=i,a&&("object"==typeof a&&r(a,o),i.state=function(){return r(o,{})}),i}e&&e.exports?e.exports=o:this.xor128=o}(0,t)}(sa);var fa=sa.exports,ua={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function o(t,e){var o=new n(t),a=e&&e.state,i=function(){return(o.next()>>>0)/4294967296};return i.double=function(){do{var t=((o.next()>>>11)+(o.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=o.next,i.quick=i,a&&("object"==typeof a&&r(a,o),i.state=function(){return r(o,{})}),i}e&&e.exports?e.exports=o:this.xorwow=o}(0,t)}(ua);var la=ua.exports,da={exports:{}};!function(t){!function(t,e){function n(t){var e=this;e.next=function(){var t,n,r=e.x,o=e.i;return t=r[o],n=(t^=t>>>7)^t<<24,n^=(t=r[o+1&7])^t>>>10,n^=(t=r[o+3&7])^t>>>3,n^=(t=r[o+4&7])^t<<7,t=r[o+7&7],n^=(t^=t<<13)^t<<9,r[o]=n,e.i=o+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function r(t,e){return e.x=t.x.slice(),e.i=t.i,e}function o(t,e){null==t&&(t=+new Date);var o=new n(t),a=e&&e.state,i=function(){return(o.next()>>>0)/4294967296};return i.double=function(){do{var t=((o.next()>>>11)+(o.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=o.next,i.quick=i,a&&(a.x&&r(a,o),i.state=function(){return r(o,{})}),i}e&&e.exports?e.exports=o:this.xorshift7=o}(0,t)}(da);var ha=da.exports,ga={exports:{}};!function(t){!function(t,e){function n(t){var e=this;e.next=function(){var t,n,r=e.w,o=e.X,a=e.i;return e.w=r=r+1640531527|0,n=o[a+34&127],t=o[a=a+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=o[a]=n^t,e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,o,a,i,c=[],s=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,s=Math.max(s,e.length)),o=0,a=-32;a<s;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(i=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(i=i+1640531527|0,o=0==(n=c[127&a]^=r+i)?o+1:0);for(o>=128&&(c[127&(e&&e.length||0)]=-1),o=127,a=512;a>0;--a)r=c[o+34&127],n=c[o=o+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,c[o]=r^n;t.w=i,t.X=c,t.i=o}(e,t)}function r(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function o(t,e){null==t&&(t=+new Date);var o=new n(t),a=e&&e.state,i=function(){return(o.next()>>>0)/4294967296};return i.double=function(){do{var t=((o.next()>>>11)+(o.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=o.next,i.quick=i,a&&(a.X&&r(a,o),i.state=function(){return r(o,{})}),i}e&&e.exports?e.exports=o:this.xor4096=o}(0,t)}(ga);var ba=ga.exports,pa={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,o=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^o,o=o-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^o,e.a=o-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function r(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function o(t,e){var o=new n(t),a=e&&e.state,i=function(){return(o.next()>>>0)/4294967296};return i.double=function(){do{var t=((o.next()>>>11)+(o.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=o.next,i.quick=i,a&&("object"==typeof a&&r(a,o),i.state=function(){return r(o,{})}),i}e&&e.exports?e.exports=o:this.tychei=o}(0,t)}(pa);var ma=pa.exports,wa={exports:{}},ya=aa(Object.freeze({__proto__:null,default:{}}));!function(t){!function(e,n,r){var o,a=256,i="random",c=r.pow(a,6),s=r.pow(2,52),f=2*s,u=255;function l(t,u,l){var m=[],w=b(g((u=1==u?{entropy:!0}:u||{}).entropy?[t,p(n)]:null==t?function(){try{var t;return o&&(t=o.randomBytes)?t=t(a):(t=new Uint8Array(a),(oa.crypto||oa.msCrypto).getRandomValues(t)),p(t)}catch(t){var r=oa.navigator,i=r&&r.plugins;return[+new Date,e,i,oa.screen,p(n)]}}():t,3),m),y=new d(m),M=function(){for(var t=y.g(6),e=c,n=0;t<s;)t=(t+n)*a,e*=a,n=y.g(1);for(;t>=f;)t/=2,e/=2,n>>>=1;return(t+n)/e};return M.int32=function(){return 0|y.g(4)},M.quick=function(){return y.g(4)/4294967296},M.double=M,b(p(y.S),n),(u.pass||l||function(t,e,n,o){return o&&(o.S&&h(o,y),t.state=function(){return h(y,{})}),n?(r[i]=t,e):t})(M,w,"globalThis"in u?u.globalThis:this==r,u.state)}function d(t){var e,n=t.length,r=this,o=0,i=r.i=r.j=0,c=r.S=[];for(n||(t=[n++]);o<a;)c[o]=o++;for(o=0;o<a;o++)c[o]=c[i=u&i+t[o%n]+(e=c[o])],c[i]=e;(r.g=function(t){for(var e,n=0,o=r.i,i=r.j,c=r.S;t--;)e=c[o=u&o+1],n=n*a+c[u&(c[o]=c[i=u&i+e])+(c[i]=e)];return r.i=o,r.j=i,n})(a)}function h(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function g(t,e){var n,r=[],o=typeof t;if(e&&"object"==o)for(n in t)try{r.push(g(t[n],e-1))}catch(t){}return r.length?r:"string"==o?t:t+"\0"}function b(t,e){for(var n,r=t+"",o=0;o<r.length;)e[u&o]=u&(n^=19*e[u&o])+r.charCodeAt(o++);return p(e)}function p(t){return String.fromCharCode.apply(0,t)}if(b(r.random(),n),t.exports){t.exports=l;try{o=ya}catch(t){}}else r["seed"+i]=l}("undefined"!=typeof self?self:oa,[],Math)}(wa);var Ma=ca,va=fa,xa=la,Fa=ha,La=ba,Ca=ma,Sa=wa.exports;Sa.alea=Ma,Sa.xor128=va,Sa.xorwow=xa,Sa.xorshift7=Fa,Sa.xor4096=La,Sa.tychei=Ca;var Aa=Sa;class Ta{constructor(r){this.getLocationId=t=>e(t)?t.id:this.accessors.getLocationId(t),this.getLocationName=n=>{let r;return e(n)&&t(n)?r=n.name:this.accessors.getLocationName&&(r=this.accessors.getLocationName(n)),r||(r=`${this.getLocationId(n)}`),r},this.getLocationLat=t=>e(t)?t.lat:this.accessors.getLocationLat(t),this.getLocationLon=t=>e(t)?t.lon:this.accessors.getLocationLon(t),this.getFlowOriginId=t=>n(t)?t.origin:this.accessors.getFlowOriginId(t),this.getFlowDestId=t=>n(t)?t.dest:this.accessors.getFlowDestId(t),this.getFlowMagnitude=t=>n(t)?t.count:this.accessors.getFlowMagnitude(t),this.getFlowTime=t=>{const{getFlowTime:e}=this.accessors;return e?e(t):void 0},this.accessors=r}setAccessors(t){this.accessors=t}getFlowmapDataAccessors(){return this.accessors}}function Ia(e){const n=new Map,r=new Map,o=new Map;for(const{zoom:a,nodes:i}of e){n.set(a,i);for(const e of i)if(t(e))r.set(e.id,e);else{const{id:t}=e,n=o.get(t);(null==n||n>a)&&o.set(t,a)}}const[a,i]=de(e,t=>t.zoom);if(null==a||null==i)throw new Error("Could not determine minZoom or maxZoom");const c=new Map;for(const t of r.values()){const{zoom:e}=t;let n=c.get(e);n||(n=new Map,c.set(e,n)),s(t,e=>{n?.set(e,t)})}function s(t,e){for(const n of t.children){const t=r.get(n);t?s(t,e):e(n)}}function f(t,e){const n=c.get(e);if(!n)return;const r=n.get(t);return r?r.id:void 0}return{availableZoomLevels:e.map(t=>+t.zoom).sort((t,e)=>ae(t,e)),getClusterNodesFor:t=>{if(void 0!==t)return n.get(t)},getClusterById:t=>r.get(t),getMinZoomForLocation:t=>o.get(t)||a,expandCluster:(t,e=i)=>{const n=[],o=(t,n)=>{if(e>t.zoom)for(const e of t.children){const t=r.get(e);t?o(t,n):n.push(e)}else n.push(t.id)};return o(t,n),n},findClusterFor:f,aggregateFlows:(t,e,{getFlowOriginId:n,getFlowDestId:r,getFlowMagnitude:o},a={})=>{if(e>i)return t;const c=[],s=new Map,u=(t,e)=>`${t}:${e}`,{flowCountsMapReduce:l={map:o,reduce:(t,e)=>(t||0)+e}}=a;for(const o of t){const t=n(o),a=r(o),i=f(t,e)||t,d=f(a,e)||a,h=u(i,d);if(i===t&&d===a)c.push(o);else{let t=s.get(h);t?t.count=l.reduce(t.count,l.map(o)):(t={origin:i,dest:d,count:l.map(o),aggregate:!0},c.push(t),s.set(h,t))}}return c}}}function Da(t,{getFlowOriginId:e,getFlowDestId:n,getFlowMagnitude:r}){const o={incoming:new Map,outgoing:new Map};for(const a of t){const t=e(a),i=n(a),c=r(a);o.incoming.set(i,(o.incoming.get(i)||0)+c),o.outgoing.set(t,(o.outgoing.get(t)||0)+c)}return t=>Math.max(Math.abs(o.incoming.get(t)||0),Math.abs(o.outgoing.get(t)||0))}function Na(t,e){if(!t.length)throw new Error("No available zoom levels");return t[Math.min(le(t,Math.floor(e)),t.length-1)]}const Ea={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,makeClusterName:(t,e)=>{},makeClusterId:t=>`{[${t}]}`};function ka(t){const{index:e}=t;return null!=e}function Ua(t){const{id:e}=t;return null!=e}function Oa(t,e,n,r){const{getLocationLon:o,getLocationLat:a,getLocationId:i}=e,c={...Ea,...r},{minZoom:s,maxZoom:f,nodeSize:u,makeClusterName:l,makeClusterId:d}=c,h=new Array(f+1);let g=new Array,b=0;for(const e of t){const t=o(e),r=a(e);g.push({x:_a(t),y:Ya(r),weight:n(i(e)),zoom:1/0,index:b,parentId:-1,location:e}),b++}const p=t=>{const e=new qo(t.length,u,Float32Array);for(let n=0;n<t.length;n++)e.add(t[n].x,t[n].y);return e.finish(),e.points=t,e};h[f+1]=p(g);let m=f+1;for(let t=f;t>=s;t--){const e=Pa(g,t,h[m],c);e.length===g.length?(h[t]=h[m],h[m]=void 0,m=t,g=e):(m=t,g=e,h[t]=p(g))}if(0===h.length)return[];const w=h.map(t=>t?.points.length),y=Le(w.filter(t=>t>0));let M=function(t){let e,n=-1/0;for(let r=0;r<t.length;r++){const o=t[r];"number"==typeof o&&o>n&&(n=o,e=r)}return e}(w)??w.length-1;const v=function(t,e){const{getLocationLon:n,getLocationLat:r}=e,o=new Map;let a=0;for(const e of t){const t=`${n(e)},${r(e)}`,i=o.get(t);i||a++,o.set(t,i?i+1:1)}return a}(t,e);if(v<b){const t=function(t,e){for(let n=t.length-1;n>=0;n--)if(e(t[n],n,t))return n;return-1}(w,t=>t<=v);t>=0&&(t<M&&(h[t+1]=h[M],h.splice(t+2)),M=t+1)}const x=Math.min(M,y?w.lastIndexOf(y):M),F=new Array;m=NaN;for(let t=M;t>=x;t--){let e;const n=h[t];if(!n)continue;h[m]&&t<M&&(e=we(h[m].points,t=>t.map(t=>t.id?d(t.id):i(t.location)),t=>t.parentId));const r=[];for(const c of n.points){const{x:n,y:s,numPoints:f,location:u}=c;if(ka(c))r.push({id:i(u),zoom:t,lat:a(u),lon:o(u)});else if(Ua(c)){const{id:o}=c,a=e&&e.get(o);if(!a){console.warn("Omitting cluster with no children, point:",c);continue}const i={id:d(o),name:l(o,f),zoom:t,lat:$a(s),lon:Ba(n),children:a??[]};r.push(i)}}F.push({zoom:t,nodes:r}),m=t}return F}function za(t,e,n,r,o){return{x:t,y:e,zoom:1/0,id:n,parentId:-1,numPoints:r,weight:o}}function Pa(t,e,n,r){const o=[],{radius:a,extent:i}=r,c=a/(i*Math.pow(2,e));for(let r=0;r<t.length;r++){const a=t[r];if(a.zoom<=e)continue;a.zoom=e;const i=n.within(a.x,a.y,c);let s=a.weight||1,f=Ua(a)?a.numPoints:1,u=a.x*s,l=a.y*s;const d=(r<<5)+(e+1);for(const t of i){const r=n.points[t];if(r.zoom<=e)continue;r.zoom=e;const o=r.weight||1,a=r.numPoints||1;u+=r.x*o,l+=r.y*o,s+=o,f+=a,r.parentId=d}1===f?o.push(a):(a.parentId=d,o.push(za(u/s,l/s,d,f,s)))}return o}function Ba(t){return 360*(t-.5)}function $a(t){const e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function _a(t){return t/360+.5}function Ya(t){const e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}const ja=1e-6;let Ha="undefined"!=typeof Float32Array?Float32Array:Array;function Ga(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Ra(t,e,n,r){const o=e[0],a=e[1];return t[0]=o+r*(n[0]-o),t[1]=a+r*(n[1]-a),t}!function(){const t=function(){const t=new Ha(2);return Ha!=Float32Array&&(t[0]=0,t[1]=0),t}()}();const Za=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t};function qa(t,e,n){const r=e[0],o=e[1],a=e[2],i=e[3],c=e[4],s=e[5],f=e[6],u=e[7],l=e[8],d=e[9],h=e[10],g=e[11],b=e[12],p=e[13],m=e[14],w=e[15];let y=n[0],M=n[1],v=n[2],x=n[3];return t[0]=y*r+M*c+v*l+x*b,t[1]=y*o+M*s+v*d+x*p,t[2]=y*a+M*f+v*h+x*m,t[3]=y*i+M*u+v*g+x*w,y=n[4],M=n[5],v=n[6],x=n[7],t[4]=y*r+M*c+v*l+x*b,t[5]=y*o+M*s+v*d+x*p,t[6]=y*a+M*f+v*h+x*m,t[7]=y*i+M*u+v*g+x*w,y=n[8],M=n[9],v=n[10],x=n[11],t[8]=y*r+M*c+v*l+x*b,t[9]=y*o+M*s+v*d+x*p,t[10]=y*a+M*f+v*h+x*m,t[11]=y*i+M*u+v*g+x*w,y=n[12],M=n[13],v=n[14],x=n[15],t[12]=y*r+M*c+v*l+x*b,t[13]=y*o+M*s+v*d+x*p,t[14]=y*a+M*f+v*h+x*m,t[15]=y*i+M*u+v*g+x*w,t}function Va(t,e,n){const r=n[0],o=n[1],a=n[2];let i,c,s,f,u,l,d,h,g,b,p,m;return e===t?(t[12]=e[0]*r+e[4]*o+e[8]*a+e[12],t[13]=e[1]*r+e[5]*o+e[9]*a+e[13],t[14]=e[2]*r+e[6]*o+e[10]*a+e[14],t[15]=e[3]*r+e[7]*o+e[11]*a+e[15]):(i=e[0],c=e[1],s=e[2],f=e[3],u=e[4],l=e[5],d=e[6],h=e[7],g=e[8],b=e[9],p=e[10],m=e[11],t[0]=i,t[1]=c,t[2]=s,t[3]=f,t[4]=u,t[5]=l,t[6]=d,t[7]=h,t[8]=g,t[9]=b,t[10]=p,t[11]=m,t[12]=i*r+u*o+g*a+e[12],t[13]=c*r+l*o+b*a+e[13],t[14]=s*r+d*o+p*a+e[14],t[15]=f*r+h*o+m*a+e[15]),t}function Ka(t,e,n){const r=n[0],o=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*o,t[5]=e[5]*o,t[6]=e[6]*o,t[7]=e[7]*o,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}!function(){const t=function(){const t=new Ha(3);return Ha!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}()}();const Wa=function(t,e,n,r,o){const a=1/Math.tan(e/2);if(t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0){const e=1/(r-o);t[10]=(o+r)*e,t[14]=2*o*r*e}else t[10]=-1,t[14]=-2*r;return t};function Xa(t,e){const n=t[0],r=t[1],o=t[2],a=t[3],i=t[4],c=t[5],s=t[6],f=t[7],u=t[8],l=t[9],d=t[10],h=t[11],g=t[12],b=t[13],p=t[14],m=t[15],w=e[0],y=e[1],M=e[2],v=e[3],x=e[4],F=e[5],L=e[6],C=e[7],S=e[8],A=e[9],T=e[10],I=e[11],D=e[12],N=e[13],E=e[14],k=e[15];return Math.abs(n-w)<=ja*Math.max(1,Math.abs(n),Math.abs(w))&&Math.abs(r-y)<=ja*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(o-M)<=ja*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(a-v)<=ja*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(i-x)<=ja*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(c-F)<=ja*Math.max(1,Math.abs(c),Math.abs(F))&&Math.abs(s-L)<=ja*Math.max(1,Math.abs(s),Math.abs(L))&&Math.abs(f-C)<=ja*Math.max(1,Math.abs(f),Math.abs(C))&&Math.abs(u-S)<=ja*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(l-A)<=ja*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(d-T)<=ja*Math.max(1,Math.abs(d),Math.abs(T))&&Math.abs(h-I)<=ja*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(g-D)<=ja*Math.max(1,Math.abs(g),Math.abs(D))&&Math.abs(b-N)<=ja*Math.max(1,Math.abs(b),Math.abs(N))&&Math.abs(p-E)<=ja*Math.max(1,Math.abs(p),Math.abs(E))&&Math.abs(m-k)<=ja*Math.max(1,Math.abs(m),Math.abs(k))}function Ja(t,e){const n=function(t,e,n){const r=e[0],o=e[1],a=e[2],i=e[3];return t[0]=n[0]*r+n[4]*o+n[8]*a+n[12]*i,t[1]=n[1]*r+n[5]*o+n[9]*a+n[13]*i,t[2]=n[2]*r+n[6]*o+n[10]*a+n[14]*i,t[3]=n[3]*r+n[7]*o+n[11]*a+n[15]*i,t}([],e,t);var r,o,a;return r=n,o=n,a=1/n[3],r[0]=o[0]*a,r[1]=o[1]*a,r[2]=o[2]*a,r[3]=o[3]*a,n}function Qa(t,e,n){return t<e?e:t>n?n:t}!function(){const t=function(){const t=new Ha(4);return Ha!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}()}();const ti=Math.log2||function(t){return Math.log(t)*Math.LOG2E};function ei(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const ni=Math.PI,ri=ni/4,oi=ni/180,ai=180/ni,ii=512,ci=85.051129,si=1.5;function fi(t){const[e,n]=t;ei(Number.isFinite(e)),ei(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=n*oi;return[ii*(e*oi+ni)/(2*ni),ii*(ni+Math.log(Math.tan(ri+.5*r)))/(2*ni)]}function ui(t){const[e,n]=t,r=e/ii*(2*ni)-ni,o=2*(Math.atan(Math.exp(n/ii*(2*ni)-ni))-ri);return[r*ai,o*ai]}function li(t){const{height:e,pitch:n,bearing:r,altitude:o,scale:a,center:i}=t,c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Va(c,c,[0,0,-o]),function(t,e,n){const r=Math.sin(n),o=Math.cos(n),a=e[4],i=e[5],c=e[6],s=e[7],f=e[8],u=e[9],l=e[10],d=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*o+f*r,t[5]=i*o+u*r,t[6]=c*o+l*r,t[7]=s*o+d*r,t[8]=f*o-a*r,t[9]=u*o-i*r,t[10]=l*o-c*r,t[11]=d*o-s*r}(c,c,-n*oi),function(t,e,n){const r=Math.sin(n),o=Math.cos(n),a=e[0],i=e[1],c=e[2],s=e[3],f=e[4],u=e[5],l=e[6],d=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*o+f*r,t[1]=i*o+u*r,t[2]=c*o+l*r,t[3]=s*o+d*r,t[4]=f*o-a*r,t[5]=u*o-i*r,t[6]=l*o-c*r,t[7]=d*o-s*r}(c,c,r*oi);const s=a/e;var f,u;return Ka(c,c,[s,s,s]),i&&Va(c,c,((f=[])[0]=-(u=i)[0],f[1]=-u[1],f[2]=-u[2],f)),c}function di(t){const{fov:e,aspect:n,near:r,far:o}=function(t){const{width:e,height:n,altitude:r,pitch:o=0,offset:a,center:i,scale:c,nearZMultiplier:s=1,farZMultiplier:f=1}=t;let{fovy:u=hi(si)}=t;void 0!==r&&(u=hi(r));const l=u*oi,d=o*oi,h=gi(u);let g=h;i&&(g+=i[2]*c/Math.cos(d)/n);const b=l*(.5+(a?a[1]:0)/n),p=Math.sin(b)*g/Math.sin(Qa(Math.PI/2-d-b,.01,Math.PI-.01)),m=Math.sin(d)*p+g,w=10*g;return{fov:l,aspect:e/n,focalDistance:h,near:s,far:Math.min(m*f,w)}}(t);return Wa([],e,n,r,o)}function hi(t){return 2*Math.atan(.5/t)*ai}function gi(t){return.5/Math.tan(.5*t*oi)}function bi(t,e,n=0){const[r,o,a]=t;if(ei(Number.isFinite(r)&&Number.isFinite(o),"invalid pixel coordinate"),Number.isFinite(a)){return Ja(e,[r,o,a,1])}const i=Ja(e,[r,o,0,1]),c=Ja(e,[r,o,1,1]),s=i[2],f=c[2];return Ra([],i,c,s===f?0:((n||0)-s)/(f-s))}function pi(t){const{width:e,height:n,bounds:r,minExtent:o=0,maxZoom:a=24,offset:i=[0,0]}=t,[[c,s],[f,u]]=r,l=function(t=0){if("number"==typeof t)return{top:t,bottom:t,left:t,right:t};return ei(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t}(t.padding),d=fi([c,Qa(u,-85.051129,ci)]),h=fi([f,Qa(s,-85.051129,ci)]),g=[Math.max(Math.abs(h[0]-d[0]),o),Math.max(Math.abs(h[1]-d[1]),o)],b=[e-l.left-l.right-2*Math.abs(i[0]),n-l.top-l.bottom-2*Math.abs(i[1])];ei(b[0]>0&&b[1]>0);const p=b[0]/g[0],m=b[1]/g[1],w=(l.right-l.left)/2/p,y=(l.top-l.bottom)/2/m,M=ui([(h[0]+d[0])/2+w,(h[1]+d[1])/2+y]),v=Math.min(a,ti(Math.abs(Math.min(p,m))));return ei(Number.isFinite(v)),{longitude:M[0],latitude:M[1],zoom:v}}const mi=Math.PI/180;function wi(t,e,n){const{pixelUnprojectionMatrix:r}=t,o=Ja(r,[e,0,1,1]),a=Ja(r,[e,t.height,1,1]),i=ui(Ra([],o,a,(n*t.distanceScales.unitsPerMeter[2]-o[2])/(a[2]-o[2])));return i.push(n),i}class yi{constructor(t={width:1,height:1}){this.equals=t=>t instanceof yi&&(t.width===this.width&&t.height===this.height&&Xa(t.projectionMatrix,this.projectionMatrix)&&Xa(t.viewMatrix,this.viewMatrix)),this.project=(t,e={})=>{const{topLeft:n=!0}=e,r=function(t,e){const[n,r,o=0]=t;return ei(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(o)),Ja(e,[n,r,o,1])}(this.projectPosition(t),this.pixelProjectionMatrix),[o,a]=r,i=n?a:this.height-a;return 2===t.length?[o,i]:[o,i,r[2]]},this.unproject=(t,e={})=>{const{topLeft:n=!0,targetZ:r}=e,[o,a,i]=t,c=n?a:this.height-a,s=r&&r*this.distanceScales.unitsPerMeter[2],f=bi([o,c,i],this.pixelUnprojectionMatrix,s),[u,l,d]=this.unprojectPosition(f);return Number.isFinite(i)?[u,l,d]:Number.isFinite(r)?[u,l,r]:[u,l]},this.projectPosition=t=>{const[e,n]=fi(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]},this.unprojectPosition=t=>{const[e,n]=ui(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]};let{width:e,height:n,altitude:r=null,fovy:o=null}=t;const{latitude:a=0,longitude:i=0,zoom:c=0,pitch:s=0,bearing:f=0,position:u=null,nearZMultiplier:l=.02,farZMultiplier:d=1.01}=t;e=e||1,n=n||1,null===o&&null===r?(r=si,o=hi(r)):null===o?o=hi(r):null===r&&(r=gi(o));const h=function(t){return Math.pow(2,t)}(c);r=Math.max(.75,r);const g=function(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;ei(Number.isFinite(e)&&Number.isFinite(n));const o=ii,a=Math.cos(e*oi),i=o/360,c=i/a,s=12790407194604047e-21/a,f={unitsPerMeter:[s,s,s],metersPerUnit:[1/s,1/s,1/s],unitsPerDegree:[i,c,s],degreesPerUnit:[.703125,1/c,1/s]};if(r){const t=oi*Math.tan(e*oi)/a,n=i*t/2,r=12790407194604047e-21*t,o=r/c*s;f.unitsPerDegree2=[0,n,r],f.unitsPerMeter2=[o,0,o]}return f}({longitude:i,latitude:a}),b=fi([i,a]);var p,m,w;b.push(0),u&&(p=b,m=b,w=Za([],u,g.unitsPerMeter),p[0]=m[0]+w[0],p[1]=m[1]+w[1],p[2]=m[2]+w[2]),this.projectionMatrix=di({width:e,height:n,scale:h,center:b,pitch:s,fovy:o,nearZMultiplier:l,farZMultiplier:d}),this.viewMatrix=li({height:n,scale:h,center:b,pitch:s,bearing:f,altitude:r}),this.width=e,this.height=n,this.scale=h,this.latitude=a,this.longitude=i,this.zoom=c,this.pitch=s,this.bearing=f,this.altitude=r,this.fovy=o,this.center=b,this.meterOffset=u||[0,0,0],this.distanceScales=g,this._initMatrices(),Object.freeze(this)}_initMatrices(){const{width:t,height:e,projectionMatrix:n,viewMatrix:r}=this,o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];qa(o,o,n),qa(o,o,r),this.viewProjectionMatrix=o;const a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Ka(a,a,[t/2,-e/2,1]),Va(a,a,[1,-1,0]),qa(a,a,o);const i=function(t,e){const n=e[0],r=e[1],o=e[2],a=e[3],i=e[4],c=e[5],s=e[6],f=e[7],u=e[8],l=e[9],d=e[10],h=e[11],g=e[12],b=e[13],p=e[14],m=e[15],w=n*c-r*i,y=n*s-o*i,M=n*f-a*i,v=r*s-o*c,x=r*f-a*c,F=o*f-a*s,L=u*b-l*g,C=u*p-d*g,S=u*m-h*g,A=l*p-d*b,T=l*m-h*b,I=d*m-h*p;let D=w*I-y*T+M*A+v*S-x*C+F*L;return D?(D=1/D,t[0]=(c*I-s*T+f*A)*D,t[1]=(o*T-r*I-a*A)*D,t[2]=(b*F-p*x+m*v)*D,t[3]=(d*x-l*F-h*v)*D,t[4]=(s*S-i*I-f*C)*D,t[5]=(n*I-o*S+a*C)*D,t[6]=(p*M-g*F-m*y)*D,t[7]=(u*F-d*M+h*y)*D,t[8]=(i*T-c*S+f*L)*D,t[9]=(r*S-n*T-a*L)*D,t[10]=(g*x-b*M+m*w)*D,t[11]=(l*M-u*x-h*w)*D,t[12]=(c*C-i*A-s*L)*D,t[13]=(n*A-r*C+o*L)*D,t[14]=(b*y-g*v-p*w)*D,t[15]=(u*v-l*y+d*w)*D,t):null}([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],a);if(!i)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=a,this.pixelUnprojectionMatrix=i}projectFlat(t){return fi(t)}unprojectFlat(t){return ui(t)}getMapCenterByLngLatPosition({lngLat:t,pos:e}){const n=bi(e,this.pixelUnprojectionMatrix),r=Ga([],fi(t),((o=[])[0]=-(a=n)[0],o[1]=-a[1],o));var o,a;return ui(Ga([],this.center,r))}fitBounds(t,e={}){const{width:n,height:r}=this,{longitude:o,latitude:a,zoom:i}=pi(Object.assign({width:n,height:r,bounds:t},e));return new yi({width:n,height:r,longitude:o,latitude:a,zoom:i})}getBounds(t){const e=this.getBoundingRegion(t),n=Math.min(...e.map(t=>t[0])),r=Math.max(...e.map(t=>t[0]));return[[n,Math.min(...e.map(t=>t[1]))],[r,Math.max(...e.map(t=>t[1]))]]}getBoundingRegion(t={}){return function(t,e=0){const{width:n,height:r,unproject:o}=t,a={targetZ:e},i=o([0,r],a),c=o([n,r],a);let s,f;return(t.fovy?.5*t.fovy*mi:Math.atan(.5/t.altitude))>(90-t.pitch)*mi-.01?(s=wi(t,0,e),f=wi(t,n,e)):(s=o([0,0],a),f=o([n,0],a)),[i,c,f,s]}(this,t.z||0)}getLocationAtPoint({lngLat:t,pos:e}){return this.getMapCenterByLngLatPosition({lngLat:t,pos:e})}}const Mi=(t,e=0)=>{const n=e,r=new yi({...t,width:t.width+2*n,height:t.height+2*n}).getBounds();return[r[0][0],r[0][1],r[1][0],r[1][1]]},vi=t=>{if(t)return Qe().range([.025,.5]).domain([0,Math.max.apply(null,t.map(t=>Math.abs(t||0)))])};function xi(e,n,r,o,a){const{getLocationId:i,getLocationName:c,getLocationClusterName:s}=o,f=t=>{const e=r.get(t);return e?c?c(e):i(e)||t:`"${t}"`};for(const r of n)for(const n of r.nodes)if(t(n)){const t=e.expandCluster(n);if(t.sort((t,e)=>ie(a(t),a(e))),s)n.name=s(t);else{const e=t[0],r=2===t.length?t[1]:void 0;n.name=`"${f(e)}" and ${r?`"${f(r)}"`:t.length-1+" others"}`}}else n.name=f(n.id)}const Fi=[qn("%Y-%m-%d"),qn("%Y-%m-%d %H:%M"),qn("%Y-%m-%d %H:%M:%S"),qn("%Y"),qn("%Y-%m")];var Li;!function(t){t.SECOND="SECOND",t.MINUTE="MINUTE",t.HOUR="HOUR",t.DAY="DAY",t.MONTH="MONTH",t.YEAR="YEAR"}(Li||(Li={}));const Ci=Zn(".%L"),Si=Zn(":%S"),Ai=Zn("%I:%M"),Ti=Zn("%I %p"),Ii=Zn("%a %d"),Di=Zn("%b %d"),Ni=Zn("%b"),Ei=Zn("%Y");const ki=[{order:0,key:Li.SECOND,interval:gn,format:Si,formatFull:Zn("%Y-%m-%d %H:%M:%S")},{order:1,key:Li.MINUTE,interval:bn,format:Ai,formatFull:Zn("%Y-%m-%d %H:%M")},{order:2,key:Li.HOUR,interval:mn,format:Ti,formatFull:Zn("%a %d %b %Y, %I %p")},{order:3,key:Li.DAY,interval:yn,format:Ii,formatFull:Zn("%a %d %b %Y")},{order:4,key:Li.MONTH,interval:Bn,format:Ni,formatFull:Zn("%b %Y")},{order:5,key:Li.YEAR,interval:_n,format:Ei,formatFull:Zn("%Y")}];function Ui(t){return ki.find(e=>e.key===t)}function Oi(t){return ki.find(e=>e.order===t)}function zi(t){let e;for(const n of ki){const{interval:r}=n;if(r(t)<t)return e||n;e=n}return ki[ki.length-1]}class Pi{constructor(t){this.getFlowsFromProps=(t,e)=>e.flows,this.getLocationsFromProps=(t,e)=>e.locations,this.getClusterLevelsFromProps=(t,e)=>e.clusterLevels,this.getMaxTopFlowsDisplayNum=(t,e)=>t.settings.maxTopFlowsDisplayNum,this.getSelectedLocations=(t,e)=>t.filter?.selectedLocations,this.getLocationFilterMode=(t,e)=>t.filter?.locationFilterMode,this.getClusteringEnabled=(t,e)=>t.settings.clusteringEnabled,this.getLocationTotalsEnabled=(t,e)=>t.settings.locationTotalsEnabled,this.getLocationLabelsEnabled=(t,e)=>t.settings.locationLabelsEnabled,this.getZoom=(t,e)=>t.viewport.zoom,this.getViewport=(t,e)=>t.viewport,this.getSelectedTimeRange=(t,e)=>t.filter?.selectedTimeRange,this.getColorScheme=(t,e)=>t.settings.colorScheme,this.getDarkMode=(t,e)=>t.settings.darkMode,this.getFadeEnabled=(t,e)=>t.settings.fadeEnabled,this.getFadeOpacityEnabled=(t,e)=>t.settings.fadeOpacityEnabled,this.getFadeAmount=(t,e)=>t.settings.fadeAmount,this.getAnimate=(t,e)=>t.settings.animationEnabled,this.getInvalidLocationIds=ra(this.getLocationsFromProps,t=>{if(!t)return;const e=[];for(const n of t){const t=this.accessors.getLocationId(n),r=this.accessors.getLocationLon(n),o=this.accessors.getLocationLat(n);-90<=o&&o<=90&&-180<=r&&r<=180||e.push(t)}return e.length>0?e:void 0}),this.getLocations=ra(this.getLocationsFromProps,this.getInvalidLocationIds,(t,e)=>{if(!t)return;if(!e||0===e.length)return t;const n=new Set(e),r=[];for(const e of t){const t=this.accessors.getLocationId(e);n.has(t)||r.push(e)}return r}),this.getLocationIds=ra(this.getLocations,t=>{if(!t)return;const e=new Set;for(const n of t)e.add(this.accessors.getLocationId(n));return e}),this.getSelectedLocationsSet=ra(this.getSelectedLocations,t=>t&&t.length>0?new Set(t):void 0),this.getSortedFlowsForKnownLocations=ra(this.getFlowsFromProps,this.getLocationIds,(t,e)=>{if(!e||!t)return;const n=[];for(const r of t){const t=this.accessors.getFlowOriginId(r),o=this.accessors.getFlowDestId(r);e.has(t)&&e.has(o)&&n.push(r)}return n.sort((t,e)=>ie(Math.abs(this.accessors.getFlowMagnitude(t)),Math.abs(this.accessors.getFlowMagnitude(e))))}),this.getActualTimeExtent=ra(this.getSortedFlowsForKnownLocations,t=>{if(!t)return;let e=null,n=null;for(const r of t){const t=this.accessors.getFlowTime(r);t&&((null==e||e>t)&&(e=t),(null==n||n<t)&&(n=t))}return e&&n?[e,n]:void 0}),this.getTimeGranularityKey=ra(this.getSortedFlowsForKnownLocations,this.getActualTimeExtent,(t,e)=>{if(!t||!e)return;const n=Le(t,t=>{const e=this.accessors.getFlowTime(t);return e?zi(e).order:null});if(null==n)return;const r=Oi(n);return r?r.key:void 0}),this.getTimeExtent=ra(this.getActualTimeExtent,this.getTimeGranularityKey,(t,e)=>{const n=e?Ui(e):void 0;if(!t||!n?.interval)return;const{interval:r}=n;return[t[0],r.offset(r.floor(t[1]),1)]}),this.getSortedFlowsForKnownLocationsFilteredByTime=ra(this.getSortedFlowsForKnownLocations,this.getTimeExtent,this.getSelectedTimeRange,(t,e,n)=>{if(t)return!e||!n||e[0]===n[0]&&e[1]===n[1]?t:t.filter(t=>{const e=this.accessors.getFlowTime(t);return e&&n[0]<=e&&e<n[1]})}),this.getLocationsHavingFlows=ra(this.getSortedFlowsForKnownLocations,this.getLocations,(t,e)=>{if(!e||!t)return e;const n=new Set;for(const e of t)n.add(this.accessors.getFlowOriginId(e)),n.add(this.accessors.getFlowDestId(e));const r=[];for(const t of e)n.has(this.accessors.getLocationId(t))&&r.push(t);return r}),this.getLocationsById=ra(this.getLocationsHavingFlows,t=>{if(!t)return;const e=new Map;for(const n of t)e.set(this.accessors.getLocationId(n),n);return e}),this.getLocationWeightGetter=ra(this.getSortedFlowsForKnownLocations,t=>{if(!t)return;return Da(t,this.accessors.getFlowmapDataAccessors())}),this.getClusterLevels=ra(this.getClusterLevelsFromProps,this.getLocationsHavingFlows,this.getLocationWeightGetter,(t,e,n)=>{if(t)return t;if(!e||!n)return;return Oa(e,this.accessors.getFlowmapDataAccessors(),n,{maxZoom:20})}),this.getClusterIndex=ra(this.getLocationsById,this.getLocationWeightGetter,this.getClusterLevels,(t,e,n)=>{if(!t||!e||!n)return;const r=Ia(n);return xi(r,n,t,this.accessors.getFlowmapDataAccessors(),e),r}),this.getAvailableClusterZoomLevels=ra(this.getClusterIndex,this.getSelectedLocations,(t,e)=>{if(!t)return;let n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;const o=e=>{const o=t.getClusterById(e);if(o)r=Math.max(r,o.zoom),n=Math.min(n,o.zoom);else{const n=t.getMinZoomForLocation(e);r=Math.max(r,n)}};if(e)for(const t of e)o(t);return t.availableZoomLevels.filter(t=>r<=t&&t<=n)}),this._getClusterZoom=ra(this.getClusterIndex,this.getZoom,this.getAvailableClusterZoomLevels,(t,e,n)=>{if(!t)return;if(!n||null==e)return;return Na(n,e)}),this.getClusterZoom=(t,e)=>{const{settings:n}=t;if(n.clusteringEnabled)return n.clusteringAuto||null==n.clusteringLevel?this._getClusterZoom(t,e):n.clusteringLevel},this.getLocationsForSearchBox=ra(this.getClusteringEnabled,this.getLocationsHavingFlows,this.getSelectedLocations,this.getClusterZoom,this.getClusterIndex,(t,n,r,o,a)=>{if(!n)return;let i=Array.from(n);if(a&&r){const t=[];for(const n of r){const r=a.getClusterById(n);r&&!i.find(t=>(e(t)?t.id:this.accessors.getLocationId(t))===n)&&t.push(r)}t.length>0&&(i=i.concat(t))}return i}),this.getDiffMode=ra(this.getFlowsFromProps,t=>{if(t)for(const e of t)if(this.accessors.getFlowMagnitude(e)<0)return!0;return!1}),this._getFlowmapColors=ra(this.getDiffMode,this.getColorScheme,this.getDarkMode,this.getFadeEnabled,this.getFadeOpacityEnabled,this.getFadeAmount,this.getAnimate,Oo),this.getFlowmapColorsRGBA=ra(this._getFlowmapColors,t=>Bo(t)?Go(t):Ho(t)),this.getUnknownLocations=ra(this.getLocationIds,this.getFlowsFromProps,this.getSortedFlowsForKnownLocations,(t,e,n)=>{if(!t||!e)return;if(n)return;const r=new Set;for(const n of e)t.has(this.accessors.getFlowOriginId(n))||r.add(this.accessors.getFlowOriginId(n)),t.has(this.accessors.getFlowDestId(n))||r.add(this.accessors.getFlowDestId(n));return r}),this.getSortedAggregatedFilteredFlows=ra(this.getClusterIndex,this.getClusteringEnabled,this.getSortedFlowsForKnownLocationsFilteredByTime,this.getClusterZoom,this.getTimeExtent,(t,e,n,r,o)=>{if(!n)return;let a;return a=e&&t&&null!=r?t.aggregateFlows(n,r,this.accessors.getFlowmapDataAccessors()):function(t,e){const n=we(t,t=>({aggregate:!0,origin:e.getFlowOriginId(t[0]),dest:e.getFlowDestId(t[0]),count:t.reduce((t,n)=>{const r=e.getFlowMagnitude(n);return r&&!isNaN(r)&&isFinite(r)?t+r:t},0)}),e.getFlowOriginId,e.getFlowDestId),r=[];for(const t of n.values())for(const e of t.values())r.push(e);return r}(n,this.accessors.getFlowmapDataAccessors()),a.sort((t,e)=>ie(Math.abs(this.accessors.getFlowMagnitude(t)),Math.abs(this.accessors.getFlowMagnitude(e)))),a}),this.getExpandedSelectedLocationsSet=ra(this.getClusteringEnabled,this.getSelectedLocationsSet,this.getClusterIndex,(t,e,n)=>{if(!e||!n)return e;const r=new Set;for(const t of e){const e=n.getClusterById(t);if(e){const t=n.expandCluster(e);for(const e of t)r.add(e)}else r.add(t)}return r}),this.getTotalCountsByTime=ra(this.getSortedFlowsForKnownLocations,this.getTimeGranularityKey,this.getTimeExtent,this.getExpandedSelectedLocationsSet,this.getLocationFilterMode,(t,e,n,r,o)=>{const a=e?Ui(e):void 0;if(!t||!a||!n)return;const i=t.reduce((t,e)=>{if(this.isFlowInSelection(e,r,o)){const n=a.interval(this.accessors.getFlowTime(e)).getTime();t.set(n,(t.get(n)??0)+this.accessors.getFlowMagnitude(e))}return t},new Map);return Array.from(i.entries()).map(([t,e])=>({time:new Date(t),count:e}))}),this.getMaxLocationCircleSize=ra(this.getLocationTotalsEnabled,t=>t?17:1),this.getViewportBoundingBox=ra(this.getViewport,this.getMaxLocationCircleSize,Mi),this.getLocationsForZoom=ra(this.getClusteringEnabled,this.getLocationsHavingFlows,this.getClusterIndex,this.getClusterZoom,(t,e,n,r)=>t&&n?n.getClusterNodesFor(r):e),this.getLocationTotals=ra(this.getLocationsForZoom,this.getSortedAggregatedFilteredFlows,this.getSelectedLocationsSet,this.getLocationFilterMode,(t,e,n,r)=>{if(!e)return;const o=new Map,a=(t,e)=>{const n=o.get(t)??{incomingCount:0,outgoingCount:0,internalCount:0};return null!=e.incomingCount&&(n.incomingCount+=e.incomingCount),null!=e.outgoingCount&&(n.outgoingCount+=e.outgoingCount),null!=e.internalCount&&(n.internalCount+=e.internalCount),n};for(const t of e)if(this.isFlowInSelection(t,n,r)){const e=this.accessors.getFlowOriginId(t),n=this.accessors.getFlowDestId(t),r=this.accessors.getFlowMagnitude(t);e===n?o.set(e,a(e,{internalCount:r})):(o.set(e,a(e,{outgoingCount:r})),o.set(n,a(n,{incomingCount:r})))}return o}),this.getLocationsTree=ra(this.getLocationsForZoom,t=>{if(!t)return;const e=Array.isArray(t)?t:Array.from(t),n=new qo(e.length,64,Float32Array);for(let t=0;t<e.length;t++){const r=e[t];n.add($i(this.accessors.getLocationLon(r)),_i(this.accessors.getLocationLat(r)))}return n.finish(),n.points=e,n}),this._getLocationIdsInViewport=ra(this.getLocationsTree,this.getViewportBoundingBox,(t,e)=>{const n=this._getLocationsInBboxIndices(t,e);if(n)return new Set(n.map(e=>this.accessors.getLocationId(t.points[e])))}),this.getLocationIdsInViewport=na(ea,(t,e,n)=>{if(t===e)return!0;if(null==t||null==e)return!1;if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0})(this._getLocationIdsInViewport,t=>{if(t)return t}),this.getTotalUnfilteredCount=ra(this.getSortedFlowsForKnownLocations,t=>{if(t)return t.reduce((t,e)=>t+this.accessors.getFlowMagnitude(e),0)}),this.getTotalFilteredCount=ra(this.getSortedAggregatedFilteredFlows,this.getSelectedLocationsSet,this.getLocationFilterMode,(t,e,n)=>{if(!t)return;return t.reduce((t,r)=>this.isFlowInSelection(r,e,n)?t+this.accessors.getFlowMagnitude(r):t,0)}),this._getLocationTotalsExtent=ra(this.getLocationTotals,t=>Bi(t,void 0)),this._getLocationTotalsForViewportExtent=ra(this.getLocationTotals,this.getLocationIdsInViewport,(t,e)=>Bi(t,e)),this.getLocationTotalsExtent=(t,e)=>t.settings.adaptiveScalesEnabled?this._getLocationTotalsForViewportExtent(t,e):this._getLocationTotalsExtent(t,e),this.getFlowsForFlowmapLayer=ra(this.getSortedAggregatedFilteredFlows,this.getLocationIdsInViewport,this.getSelectedLocationsSet,this.getLocationFilterMode,this.getMaxTopFlowsDisplayNum,(t,e,n,r,o)=>{if(!t||!e)return;const a=[];let i=0;for(const c of t){const t=this.accessors.getFlowOriginId(c),s=this.accessors.getFlowDestId(c);if((e.has(t)||e.has(s))&&this.isFlowInSelection(c,n,r)&&t!==s&&(a.push(c),i++),i>o)break}return a.reverse()}),this._getFlowMagnitudeExtent=ra(this.getSortedAggregatedFilteredFlows,this.getSelectedLocationsSet,this.getLocationFilterMode,(t,e,n)=>{if(!t)return;let r;for(const o of t)if(this.accessors.getFlowOriginId(o)!==this.accessors.getFlowDestId(o)&&this.isFlowInSelection(o,e,n)){const t=this.accessors.getFlowMagnitude(o);null==r?r=[t,t]:(t<r[0]&&(r[0]=t),t>r[1]&&(r[1]=t))}return r}),this._getAdaptiveFlowMagnitudeExtent=ra(this.getFlowsForFlowmapLayer,t=>{if(!t)return;const e=de(t,this.accessors.getFlowMagnitude);return void 0!==e[0]&&void 0!==e[1]?e:void 0}),this.getFlowMagnitudeExtent=(t,e)=>t.settings.adaptiveScalesEnabled?this._getAdaptiveFlowMagnitudeExtent(t,e):this._getFlowMagnitudeExtent(t,e),this.getLocationMaxAbsTotalGetter=ra(this.getLocationTotals,t=>e=>{const n=t?.get(e);if(n)return Math.max(Math.abs(n.incomingCount+n.internalCount),Math.abs(n.outgoingCount+n.internalCount))}),this.getFlowThicknessScale=ra(this.getFlowMagnitudeExtent,vi),this.getCircleSizeScale=ra(this.getMaxLocationCircleSize,this.getLocationTotalsEnabled,this.getLocationTotalsExtent,(t,e,n)=>e?n?function(){return on.apply(null,arguments).exponent(.5)}().range([0,t]).domain([0,Math.max.apply(null,n.map(t=>Math.abs(t||0)))]):void 0:()=>t),this.getInCircleSizeGetter=ra(this.getCircleSizeScale,this.getLocationTotals,(t,e)=>n=>{const r=e?.get(n);return r&&t&&t(Math.abs(r.incomingCount+r.internalCount))||0}),this.getOutCircleSizeGetter=ra(this.getCircleSizeScale,this.getLocationTotals,(t,e)=>n=>{const r=e?.get(n);return r&&t&&t(Math.abs(r.outgoingCount+r.internalCount))||0}),this.getSortedLocationsForZoom=ra(this.getLocationsForZoom,this.getInCircleSizeGetter,this.getOutCircleSizeGetter,(t,e,n)=>{if(!t)return;return[...t].sort((t,r)=>{const o=this.accessors.getLocationId(t),a=this.accessors.getLocationId(r);return ae(Math.max(e(o),n(o)),Math.max(e(a),n(a)))})}),this.getLocationsForFlowmapLayer=ra(this.getSortedLocationsForZoom,t=>t),this.getLocationsForFlowmapLayerById=ra(this.getLocationsForFlowmapLayer,t=>{if(t)return t.reduce((t,e)=>(t.set(this.accessors.getLocationId(e),e),t),new Map)}),this.getLocationOrClusterByIdGetter=ra(this.getClusterIndex,this.getLocationsById,(t,e)=>n=>t?.getClusterById(n)??e?.get(n)),this.getLayersData=ra(this.getLocationsForFlowmapLayer,this.getFlowsForFlowmapLayer,this.getFlowmapColorsRGBA,this.getLocationsForFlowmapLayerById,this.getLocationIdsInViewport,this.getInCircleSizeGetter,this.getOutCircleSizeGetter,this.getFlowThicknessScale,this.getAnimate,this.getLocationLabelsEnabled,(t,e,n,r,o,a,i,c,s,f)=>this._prepareLayersData(t,e,n,r,o,a,i,c,s,f)),this.accessors=new Ta(t),this.setAccessors(t)}setAccessors(t){this.accessors=new Ta(t)}getAggregateAccessors(){return this.accessors}prepareLayersData(t,e){const n=this.getLocationsForFlowmapLayer(t,e)||[],r=this.getFlowsForFlowmapLayer(t,e)||[],o=this.getFlowmapColorsRGBA(t,e),a=this.getLocationsForFlowmapLayerById(t,e),i=this.getLocationIdsInViewport(t,e),c=this.getInCircleSizeGetter(t,e),s=this.getOutCircleSizeGetter(t,e),f=this.getFlowThicknessScale(t,e),u=this.getLocationLabelsEnabled(t,e);return this._prepareLayersData(n,r,o,a,i,c,s,f,t.settings.animationEnabled,u)}_prepareLayersData(t,e,n,r,o,a,i,c,s,f){t||(t=[]),e||(e=[]);const{getFlowOriginId:u,getFlowDestId:l,getFlowMagnitude:d,getLocationId:h,getLocationLon:g,getLocationLat:b,getLocationName:p}=this.accessors,m=Po(n,de(e,t=>d(t)),!1),w=Float32Array.from(function*(){for(const e of t)yield g(e),yield b(e)}()),y=$o(n)?n.positive.locationCircles.inner:n.locationCircles.inner,M=Uint8Array.from(function*(){for(const e of t)yield*y}()),v=Float32Array.from(function*(){for(const e of t){const t=h(e);yield o?.has(t)?a(t):1}}()),x=Float32Array.from(function*(){for(const e of t){const t=h(e);yield o?.has(t)?i(t):1}}()),F=Float32Array.from(function*(){for(const t of e){const e=r?.get(u(t));yield e?g(e):0,yield e?b(e):0}}()),L=Float32Array.from(function*(){for(const t of e){const e=r?.get(l(t));yield e?g(e):0,yield e?b(e):0}}()),C=Float32Array.from(function*(){for(const t of e)yield c&&c(d(t))||0}()),S=Float32Array.from(function*(){for(const t of e){const e=u(t),n=l(t);yield Math.max(a(e),i(e)),yield Math.max(a(n),i(n))}}()),A=Uint8Array.from(function*(){for(const t of e)yield*m(d(t))}()),T=s?Float32Array.from(function*(){for(const t of e)yield new Aa.alea(`${u(t)}-${l(t)}`)()}()):void 0;return{circleAttributes:{length:t.length,attributes:{getPosition:{value:w,size:2},getColor:{value:M,size:4},getInRadius:{value:v,size:1},getOutRadius:{value:x,size:1}}},lineAttributes:{length:e.length,attributes:{getSourcePosition:{value:F,size:2},getTargetPosition:{value:L,size:2},getThickness:{value:C,size:1},getColor:{value:A,size:4},getEndpointOffsets:{value:S,size:2},...T?{getStaggering:{value:T,size:1}}:{}}},...f?{locationLabels:t.map(p)}:void 0}}getLocationsInBbox(t,e){if(t)return this._getLocationsInBboxIndices(t,e).map(e=>t.points[e])}_getLocationsInBboxIndices(t,e){if(!t)return;const[n,r,o,a]=e,[i,c,s,f]=[$i(n),_i(r),$i(o),_i(a)];return t.range(Math.min(i,s),Math.min(c,f),Math.max(i,s),Math.max(c,f))}isFlowInSelection(t,e,n){const o=this.accessors.getFlowOriginId(t),a=this.accessors.getFlowDestId(t);if(e)switch(n){case r.ALL:return e.has(o)||e.has(a);case r.BETWEEN:return e.has(o)&&e.has(a);case r.INCOMING:return e.has(a);case r.OUTGOING:return e.has(o)}return!0}}function Bi(t,e){if(!t)return;let n;for(const[r,{incomingCount:o,outgoingCount:a,internalCount:i}]of t.entries())if(null==e||e.has(r)){const t=Math.min(o+i,a+i,i),e=Math.max(o+i,a+i,i);n?(t<n[0]&&(n[0]=t),e>n[1]&&(n[1]=e)):n=[t,e]}return n}function $i(t){return t/360+.5}function _i(t){const e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}var Yi=1e-6,ji=Math.PI,Hi=ji/2,Gi=ji/4,Ri=2*ji,Zi=180/ji,qi=ji/180,Vi=Math.abs,Ki=Math.atan2,Wi=Math.cos,Xi=Math.sin,Ji=Math.sqrt;function Qi(){}function tc(t,e){t&&nc.hasOwnProperty(t.type)&&nc[t.type](t,e)}var ec={Feature:function(t,e){tc(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,o=n.length;++r<o;)tc(n[r].geometry,e)}},nc={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,o=n.length;++r<o;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){rc(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,o=n.length;++r<o;)rc(n[r],e,0)},Polygon:function(t,e){oc(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,o=n.length;++r<o;)oc(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,o=n.length;++r<o;)tc(n[r],e)}};function rc(t,e,n){var r,o=-1,a=t.length-n;for(e.lineStart();++o<a;)r=t[o],e.point(r[0],r[1],r[2]);e.lineEnd()}function oc(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)rc(t[n],e,1);e.polygonEnd()}var ac,ic,cc,sc,fc,uc,lc,dc,hc,gc,bc,pc,mc,wc,yc,Mc,vc=new he,xc=new he,Fc={point:Qi,lineStart:Qi,lineEnd:Qi,polygonStart:function(){vc=new he,Fc.lineStart=Lc,Fc.lineEnd=Cc},polygonEnd:function(){var t=+vc;xc.add(t<0?Ri+t:t),this.lineStart=this.lineEnd=this.point=Qi},sphere:function(){xc.add(Ri)}};function Lc(){Fc.point=Sc}function Cc(){Ac(ac,ic)}function Sc(t,e){Fc.point=Ac,ac=t,ic=e,cc=t*=qi,sc=Wi(e=(e*=qi)/2+Gi),fc=Xi(e)}function Ac(t,e){var n=(t*=qi)-cc,r=n>=0?1:-1,o=r*n,a=Wi(e=(e*=qi)/2+Gi),i=Xi(e),c=fc*i,s=sc*a+c*Wi(o),f=c*r*Xi(o);vc.add(Ki(f,s)),cc=t,sc=a,fc=i}function Tc(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}var Ic={point:Dc,lineStart:Ec,lineEnd:kc,polygonStart:function(){Ic.point=Uc,Ic.lineStart=Oc,Ic.lineEnd=zc,wc=new he,Fc.polygonStart()},polygonEnd:function(){Fc.polygonEnd(),Ic.point=Dc,Ic.lineStart=Ec,Ic.lineEnd=kc,vc<0?(uc=-(dc=180),lc=-(hc=90)):wc>Yi?hc=90:wc<-Yi&&(lc=-90),Mc[0]=uc,Mc[1]=dc},sphere:function(){uc=-(dc=180),lc=-(hc=90)}};function Dc(t,e){yc.push(Mc=[uc=t,dc=t]),e<lc&&(lc=e),e>hc&&(hc=e)}function Nc(t,e){var n,r,o=function(t){var e=t[0],n=t[1],r=Wi(n);return[r*Wi(e),r*Xi(e),Xi(n)]}([t*qi,e*qi]);if(mc){var a=Tc(mc,o),i=Tc([a[1],-a[0],0],a);r=Ji((n=i)[0]*n[0]+n[1]*n[1]+n[2]*n[2]),n[0]/=r,n[1]/=r,n[2]/=r,i=function(t){return[Ki(t[1],t[0]),(e=t[2],e>1?Hi:e<-1?-Hi:Math.asin(e))];var e}(i);var c,s=t-gc,f=s>0?1:-1,u=i[0]*Zi*f,l=Vi(s)>180;l^(f*gc<u&&u<f*t)?(c=i[1]*Zi)>hc&&(hc=c):l^(f*gc<(u=(u+360)%360-180)&&u<f*t)?(c=-i[1]*Zi)<lc&&(lc=c):(e<lc&&(lc=e),e>hc&&(hc=e)),l?t<gc?Pc(uc,t)>Pc(uc,dc)&&(dc=t):Pc(t,dc)>Pc(uc,dc)&&(uc=t):dc>=uc?(t<uc&&(uc=t),t>dc&&(dc=t)):t>gc?Pc(uc,t)>Pc(uc,dc)&&(dc=t):Pc(t,dc)>Pc(uc,dc)&&(uc=t)}else yc.push(Mc=[uc=t,dc=t]);e<lc&&(lc=e),e>hc&&(hc=e),mc=o,gc=t}function Ec(){Ic.point=Nc}function kc(){Mc[0]=uc,Mc[1]=dc,Ic.point=Dc,mc=null}function Uc(t,e){if(mc){var n=t-gc;wc.add(Vi(n)>180?n+(n>0?360:-360):n)}else bc=t,pc=e;Fc.point(t,e),Nc(t,e)}function Oc(){Fc.lineStart()}function zc(){Uc(bc,pc),Fc.lineEnd(),Vi(wc)>Yi&&(uc=-(dc=180)),Mc[0]=uc,Mc[1]=dc,mc=null}function Pc(t,e){return(e-=t)<0?e+360:e}function Bc(t,e){return t[0]-e[0]}function $c(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}function _c(t){var e,n,r,o,a,i,c;if(hc=dc=-(uc=lc=1/0),yc=[],function(t,e){t&&ec.hasOwnProperty(t.type)?ec[t.type](t,e):tc(t,e)}(t,Ic),n=yc.length){for(yc.sort(Bc),e=1,a=[r=yc[0]];e<n;++e)$c(r,(o=yc[e])[0])||$c(r,o[1])?(Pc(r[0],o[1])>Pc(r[0],r[1])&&(r[1]=o[1]),Pc(o[0],r[1])>Pc(r[0],r[1])&&(r[0]=o[0])):a.push(r=o);for(i=-1/0,e=0,r=a[n=a.length-1];e<=n;r=o,++e)o=a[e],(c=Pc(r[1],o[0]))>i&&(i=c,uc=o[0],dc=r[1])}return yc=Mc=null,uc===1/0||lc===1/0?[[NaN,NaN],[NaN,NaN]]:[[uc,lc],[dc,hc]]}function Yc(t,e,n){const{pad:r=.05,maxZoom:o=100}=n||{},a=_c(t),[[i,c],[s,f]]=a,u=r?[[i-r*(s-i),c-r*(f-c)],[s+r*(s-i),f+r*(f-c)]]:a,[l,d]=e;return{...pi({width:l,height:d,bounds:u,padding:n?.padding,maxZoom:o}),width:l,height:d,bearing:0,pitch:0}}function jc(t,e,n,r){const o=t=>({type:"Point",coordinates:e(t)});let a;if(Array.isArray(t))a=t.map(o);else{a=[];for(const e of t)a.push(o(e))}return Yc({type:"GeometryCollection",geometries:a},n,r)}var Hc=Object.freeze({__proto__:null,COLOR_SCHEMES:Eo,COLOR_SCHEME_KEYS:ko,get ColorScheme(){return So},DEFAULT_COLOR_SCHEME:No,FlowmapAggregateAccessors:Ta,GRAYISH:Io,LocalFlowmapDataProvider:class{constructor(t){this.selectors=new Pi(t),this.flowmapData=void 0,this.flowmapState=void 0}setAccessors(t){this.selectors.setAccessors(t)}setFlowmapData(t){this.flowmapData=t}getSelectors(){return this.selectors}getFlowmapData(){return this.flowmapData}async setFlowmapState(t){this.flowmapState=t}getFlowmapState(){return this.flowmapState}async getFlowByIndex(t){if(!this.flowmapState||!this.flowmapData)return;const e=this.selectors.getFlowsForFlowmapLayer(this.flowmapState,this.flowmapData);return e?.[t]}async getLocationByIndex(t){if(!this.flowmapState||!this.flowmapData)return;const e=this.selectors.getLocationsForFlowmapLayer(this.flowmapState,this.flowmapData);return e?.[t]}async getLayersData(){if(this.flowmapState&&this.flowmapData)return this.selectors.getLayersData(this.flowmapState,this.flowmapData)}async getLocationById(t){if(!this.flowmapState||!this.flowmapData)return;const e=this.selectors.getClusterIndex(this.flowmapState,this.flowmapData);if(e){const n=e.getClusterById(t);if(n)return n}const n=this.selectors.getLocationsById(this.flowmapState,this.flowmapData);return n?.get(t)}async getTotalsForLocation(t){if(this.flowmapState&&this.flowmapData)return this.selectors.getLocationTotals(this.flowmapState,this.flowmapData)?.get(t)}async getViewportForLocations(t,e){if(this.flowmapData?.locations)return jc(this.flowmapData.locations,t=>[this.selectors.accessors.getLocationLon(t),this.selectors.accessors.getLocationLat(t)],t,e)}async updateLayersData(t){t(await this.getLayersData())}getClusterZoom(){return this.flowmapState&&this.flowmapData?this.selectors.getClusterZoom(this.flowmapState,this.flowmapData):void 0}getClusterIndex(){return this.flowmapState&&this.flowmapData?this.selectors.getClusterIndex(this.flowmapState,this.flowmapData):void 0}getLocationsById(){return this.flowmapState&&this.flowmapData?this.selectors.getLocationsById(this.flowmapState,this.flowmapData):void 0}getLocationTotals(){return this.flowmapState&&this.flowmapData?this.selectors.getLocationTotals(this.flowmapState,this.flowmapData):void 0}getFlowsForFlowmapLayer(){return this.flowmapState&&this.flowmapData?this.selectors.getFlowsForFlowmapLayer(this.flowmapState,this.flowmapData):void 0}},get LocationFilterMode(){return r},TIME_GRANULARITIES:ki,get TimeGranularityKey(){return Li},addClusterNames:xi,areRangesEqual:function(t,e){return!t&&!e||!(!t||!e)&&(t[0]===e[0]&&t[1]===e[1])},buildIndex:Ia,clusterLocations:Oa,colorAsRgba:Fo,createFlowColorScale:zo,findAppropriateZoomLevel:Na,getColors:Oo,getColorsRGBA:Ho,getDiffColorsRGBA:Go,getFlowColorScale:Po,getFlowLineAttributesByIndex:function(t,e){const{getColor:n,getEndpointOffsets:r,getSourcePosition:o,getTargetPosition:a,getThickness:i,getStaggering:c}=t.attributes;return{length:1,attributes:{getColor:{value:n.value.subarray(4*e,4*(e+1)),size:4},getEndpointOffsets:{value:r.value.subarray(2*e,2*(e+1)),size:2},getSourcePosition:{value:o.value.subarray(2*e,2*(e+1)),size:2},getTargetPosition:{value:a.value.subarray(2*e,2*(e+1)),size:2},getThickness:{value:i.value.subarray(e,e+1),size:1},...c?{getStaggering:{value:c.value.subarray(e,e+1),size:1}}:void 0}}},getFlowThicknessScale:vi,getFlowmapColors:function(t){return Oo(!1,t.colorScheme,t.darkMode,t.fadeEnabled,t.fadeOpacityEnabled,t.fadeAmount,t.animationEnabled)},getLocationCoordsByIndex:function(t,e){const{getPosition:n}=t.attributes;return[n.value[2*e],n.value[2*e+1]]},getOuterCircleRadiusByIndex:function(t,e){const{getInRadius:n,getOutRadius:r}=t.attributes;return Math.max(n.value[e],r.value[e])},getTimeGranularityByKey:Ui,getTimeGranularityByOrder:Oi,getTimeGranularityForDate:zi,getViewStateForFeatures:Yc,getViewStateForLocations:jc,getViewportBoundingBox:Mi,isAggregateFlow:n,isCluster:t,isClusterPoint:Ua,isDiffColors:Bo,isDiffColorsRGBA:$o,isFlowmapData:function(t){return t&&t.locations&&t.flows},isFlowmapDataProvider:function(t){return t&&"function"==typeof t.setFlowmapState&&"function"==typeof t.getViewportForLocations&&"function"==typeof t.getFlowByIndex&&"function"==typeof t.getLocationById&&"function"==typeof t.getLocationByIndex&&"function"==typeof t.getLayersData},isLeafPoint:ka,isLocationClusterNode:e,makeLocationWeightGetter:Da,midpoint:Ro,mixColorsRGBA:function(t,e,n){return t.map((t,r)=>Ro(t,e[r],n))},opacifyHex:xo,opacityFloatToInteger:vo,parseTime:function(t){if(null!=t){if(t instanceof Date)return t;for(const e of Fi){const n=e(t);if(n)return n}}},rgbaAsString:function(t){return`rgba(${t.join(",")})`},schemeTeal:Do,tickMultiFormat:function(t){return(gn(t)<t?Ci:bn(t)<t?Si:mn(t)<t?Ai:yn(t)<t?Ti:Bn(t)<t?Fn(t)<t?Ii:Di:_n(t)<t?Ni:Ei)(t)}});return"undefined"!=typeof window&&(window.FlowmapData=Hc),Hc});
