{% extends 'login-layout.html' %} {% block navbar %}{% endblock %} {% from "security/_macros.html"
import prop_next, render_field_with_errors, render_field %} {% block content %}
<v-main class="d-flex flex-column align-center justify-center bg-background">
  <v-card class="login-card mx-auto pa-8 w-100" rounded="lg" style="max-width: 424px">
    <v-card-title class="text-center px-0" style="font-size: 30px; font-weight: 700; line-height: 1"
      >{{ _fsdomain('Select two-factor method') }}</v-card-title
    >
    <v-card-subtitle class="text-center pl-0 pr-0 text-pre-wrap text-body-2"
      >{{ _('Available second factor methods as below') }}</v-card-subtitle
    >

    <form
      action="{{ url_for_security('tf_select') }}{{ prop_next() }}"
      method="post"
      name="tf_select"
      id="tfForm"
      ref="tfSelectRef"
    >
      {{ two_factor_select_form.hidden_tag() }}

      <v-card-text class="px-0">
        <div class="d-flex flex-column ga-2">
          {% for value in two_factor_select_form.which.choices %}
          <v-btn
            :variant="selected2fa === '{{ value }}' ? 'flat' : 'outlined'"
            :color="selected2fa === '{{ value }}' ? 'primary' : 'grey'"
            block
            @click.prevent="selectMethod('{{ value }}')"
          >
            {{ value }}
            <v-icon>mdi-chevron-right</v-icon>
          </v-btn>
          {% endfor %}
        </div>

        <!-- Hidden input that actually submits the selected option -->
        <input type="hidden" name="{{ two_factor_select_form.which.name }}" :value="selected2fa" />
      </v-card-text>

      <v-card-text class="pt-0 pl-0 pr-0"> {% include "security/_messages.html" %}</v-card-text>
    </form>
  </v-card>

  <div class="mt-6 w-100" style="max-width: 424px;">
    <v-btn href="/login" color="primary" variant="outlined" prepend-icon="mdi-chevron-left">Back</v-btn>
  </div>
</v-main>
{% endblock content %} {% block css %}

<style></style>
{% endblock %} {% block js %}
<script>
  const { createApp } = Vue;
  const { createVuetify } = Vuetify;

  const vuetify = createVuetify(vuetifyConfig);

  const app = createApp({
    data() {
      return {
        selected2fa: '{{ two_factor_select_form.which.data or "" }}',
      };
    },
    methods: {
      selectMethod(value) {
        this.selected2fa = value;
        this.$nextTick(() => {
            this.$refs.tfSelectRef.requestSubmit();
        })
      },
    },
  });
  app.use(vuetify).mount('#app');
</script>
{% endblock %}
